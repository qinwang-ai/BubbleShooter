06b809715d9e37b416d7e58467e004ad
jsio("import ui.ImageView");jsio("import math.geom.Point as Point");jsio("import animate");jsio("import src.Bullet as Bullet");jsio("import src.Config as config");var Users_tsunami_projects_devkitPoj_BubbleShooter_src_Gun=__class__;
exports=Users_tsunami_projects_devkitPoj_BubbleShooter_src_Gun(function(){return this.init&&this.init.apply(this,arguments)},ui.ImageView,function(d){this.init=function(b){b=merge(b,{x:GLOBAL.SCREEN_SIZE.width/2-53,y:420,autoSize:!0,image:"resources/images/gun_base.png"});d(this,"init",[b]);this._color=Math.floor(5*Math.random());this.build()};this.build=function(){var b=new ui.ImageView({superview:this,x:-3,y:-70,autoSize:!0,image:"resources/images/gun.png",anchorX:53,anchorY:96}),d=new ui.ImageView({superview:this,
x:-100,y:-70,scale:0.6,autoSize:!0,image:"resources/images/girl.png"}),f=new ui.ImageView({superview:d,x:80,y:100,width:50,height:50,image:types[this._color]}),a=this,e=a.getSuperview();this.on("gun:setTarget",function(a){a=-1.57079-a.subtract(new Point(145,510)).getAngle();b.style.r=-a});this.on("gun:loaded",function(){animate(f).now({x:230,y:140},200,animate.linear).then(function(){var c=new Bullet({type:a._color,image:types[a._color]});e.addSubview(c);a._bullet=c;c._isLoaded=!0;a._color=Math.floor(5*
Math.random());f.updateOpts({x:80,y:100,image:types[a._color]})})});this.on("gun:fire",function(c){var b=e._isRemoving;e._gameStart&&(a._bullet&&a._bullet._isLoaded&&c.y<a._bullet.style.y&&!b)&&a._bullet.emit("bullet:launch",c)})}});var types=GLOBAL.TYPES;
