284542048b311847e4feb062ef51a2c5
/*
 GNU Lesser General Public License, http://www.gnu.org/copyleft/lesser.html
 @author  Jan Odvarko, http://odvarko.cz
 @created 2008-06-15
 @updated 2011-11-07
 @link    http://jscolor.com
*/
var jscolor={dir:"",bindClass:"color",binding:!0,preloading:!0,install:function(){jscolor.addEvent(window,"load",jscolor.init)},init:function(){jscolor.binding&&jscolor.bind();jscolor.preloading&&jscolor.preload()},getDir:function(){jscolor.dir="images/colorpicker/";return jscolor.dir},detectDir:function(){for(var b=location.href,f=document.getElementsByTagName("base"),a=0;a<f.length;a+=1)f[a].href&&(b=f[a].href);f=document.getElementsByTagName("script");for(a=0;a<f.length;a+=1)if(f[a].src&&/(^|\/)jscolor\.js([?#].*)?$/i.test(f[a].src))return b=
(new jscolor.URI(f[a].src)).toAbsolute(b),b.path=b.path.replace(/[^\/]+$/,""),b.query=null,b.fragment=null,b.toString();return!1},bind:function(b){b.color=new jscolor.color(b,{})},preload:function(){for(var b in jscolor.imgRequire)jscolor.imgRequire.hasOwnProperty(b)&&jscolor.loadImage(b)},images:{pad:[181,101],sld:[16,101],cross:[15,15],arrow:[7,11]},imgRequire:{},imgLoaded:{},requireImage:function(b){jscolor.imgRequire[b]=!0},loadImage:function(b){jscolor.imgLoaded[b]||(jscolor.imgLoaded[b]=new Image,
jscolor.imgLoaded[b].src=jscolor.getDir()+b)},fetchElement:function(b){return"string"===typeof b?document.getElementById(b):b},addEvent:function(b,f,a){b.addEventListener?b.addEventListener(f,a,!1):b.attachEvent&&b.attachEvent("on"+f,a)},fireEvent:function(b,f){if(b)if(document.createEvent){var a=document.createEvent("HTMLEvents");a.initEvent(f,!0,!0);b.dispatchEvent(a)}else if(document.createEventObject)a=document.createEventObject(),b.fireEvent("on"+f,a);else if(b["on"+f])b["on"+f]()},getElementPos:function(b){var f=
b,a=0,l=0;if(f.offsetParent){do a+=f.offsetLeft,l+=f.offsetTop;while(f=f.offsetParent)}for(;(b=b.parentNode)&&"BODY"!==b.nodeName.toUpperCase();)a-=b.scrollLeft,l-=b.scrollTop;return[a,l]},getElementSize:function(b){return[b.offsetWidth,b.offsetHeight]},getRelMousePos:function(b){var f=0,a=0;b||(b=window.event);"number"===typeof b.offsetX?(f=b.offsetX,a=b.offsetY):"number"===typeof b.layerX&&(f=b.layerX,a=b.layerY);return{x:f,y:a}},getViewPos:function(){return"number"===typeof window.pageYOffset?
[window.pageXOffset,window.pageYOffset]:document.body&&(document.body.scrollLeft||document.body.scrollTop)?[document.body.scrollLeft,document.body.scrollTop]:document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)?[document.documentElement.scrollLeft,document.documentElement.scrollTop]:[0,0]},getViewSize:function(){return"number"===typeof window.innerWidth?[window.innerWidth,window.innerHeight]:document.body&&(document.body.clientWidth||document.body.clientHeight)?
[document.body.clientWidth,document.body.clientHeight]:document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?[document.documentElement.clientWidth,document.documentElement.clientHeight]:[0,0]},URI:function(b){function f(a){for(var b="";a;)if("../"===a.substr(0,3)||"./"===a.substr(0,2))a=a.replace(/^\.+/,"").substr(1);else if("/./"===a.substr(0,3)||"/."===a)a="/"+a.substr(3);else if("/../"===a.substr(0,4)||"/.."===a)a="/"+a.substr(4),b=b.replace(/\/?[^\/]*$/,
"");else if("."===a||".."===a)a="";else var f=a.match(/^\/?[^\/]*/)[0],a=a.substr(f.length),b=b+f;return b}this.authority=this.scheme=null;this.path="";this.fragment=this.query=null;this.parse=function(a){a=a.match(/^(([A-Za-z][0-9A-Za-z+.-]*)(:))?((\/\/)([^\/?#]*))?([^?#]*)((\?)([^#]*))?((#)(.*))?/);this.scheme=a[3]?a[2]:null;this.authority=a[5]?a[6]:null;this.path=a[7];this.query=a[9]?a[10]:null;this.fragment=a[12]?a[13]:null;return this};this.toString=function(){var a="";null!==this.scheme&&(a=
a+this.scheme+":");null!==this.authority&&(a=a+"//"+this.authority);null!==this.path&&(a+=this.path);null!==this.query&&(a=a+"?"+this.query);null!==this.fragment&&(a=a+"#"+this.fragment);return a};this.toAbsolute=function(a){var a=new jscolor.URI(a),b=new jscolor.URI;if(null===a.scheme)return!1;null!==this.scheme&&this.scheme.toLowerCase()===a.scheme.toLowerCase()&&(this.scheme=null);null!==this.scheme?(b.scheme=this.scheme,b.authority=this.authority,b.path=f(this.path),b.query=this.query):(null!==
this.authority?(b.authority=this.authority,b.path=f(this.path),b.query=this.query):(""===this.path?(b.path=a.path,b.query=null!==this.query?this.query:a.query):("/"===this.path.substr(0,1)?b.path=f(this.path):(b.path=null!==a.authority&&""===a.path?"/"+this.path:a.path.replace(/[^\/]+$/,"")+this.path,b.path=f(b.path)),b.query=this.query),b.authority=a.authority),b.scheme=a.scheme);b.fragment=this.fragment;return b};b&&this.parse(b)},color:function(b,f){function a(c,b,a){if(null===c)return[a,a,a];
var e=Math.floor(c),d=a*(1-b),c=a*(1-b*(e%2?c-e:1-(c-e)));switch(e){case 6:case 0:return[a,c,d];case 1:return[c,a,d];case 2:return[d,a,c];case 3:return[d,c,a];case 4:return[c,d,a];case 5:return[a,d,c]}}function l(c,a){if(!jscolor.picker){jscolor.picker={box:document.createElement("div"),boxB:document.createElement("div"),pad:document.createElement("div"),padB:document.createElement("div"),padM:document.createElement("div"),sld:document.createElement("div"),sldB:document.createElement("div"),sldM:document.createElement("div"),
btn:document.createElement("div"),btnS:document.createElement("span"),btnT:document.createTextNode(e.pickerCloseText)};for(var k=0;k<jscolor.images.sld[1];k+=4){var f=document.createElement("div");f.style.height="4px";f.style.fontSize="1px";f.style.lineHeight="0";jscolor.picker.sld.appendChild(f)}jscolor.picker.sldB.appendChild(jscolor.picker.sld);jscolor.picker.box.appendChild(jscolor.picker.sldB);jscolor.picker.box.appendChild(jscolor.picker.sldM);jscolor.picker.padB.appendChild(jscolor.picker.pad);
jscolor.picker.box.appendChild(jscolor.picker.padB);jscolor.picker.box.appendChild(jscolor.picker.padM);jscolor.picker.btnS.appendChild(jscolor.picker.btnT);jscolor.picker.btn.appendChild(jscolor.picker.btnS);jscolor.picker.box.appendChild(jscolor.picker.btn);jscolor.picker.boxB.appendChild(jscolor.picker.box)}var d=jscolor.picker;d.box.onmouseup=d.box.onmouseout=function(){b.focus()};d.box.onmousedown=function(){o=!0};d.box.onmousemove=function(c){if(p||q)p&&y(c),q&&z(c),document.selection?document.selection.empty():
window.getSelection&&window.getSelection().removeAllRanges(),s()};d.padM.onmouseup=d.padM.onmouseout=function(){p&&(p=!1,jscolor.fireEvent(h,"change"))};d.padM.onmousedown=function(c){p=!0;y(c);s()};d.sldM.onmouseup=d.sldM.onmouseout=function(){q&&(q=!1,jscolor.fireEvent(h,"change"))};d.sldM.onmousedown=function(c){q=!0;z(c);s()};k=x(e);d.box.style.width=k[0]+"px";d.box.style.height=k[1]+"px";d.boxB.style.position="absolute";d.boxB.style.clear="both";d.boxB.style.left=c+"px";d.boxB.style.top=a+"px";
d.boxB.style.zIndex=e.pickerZIndex;d.boxB.className="colorMenu";d.pad.style.width=jscolor.images.pad[0]+"px";d.pad.style.height=jscolor.images.pad[1]+"px";d.padB.style.position="absolute";d.padB.style.left=e.pickerFace+"px";d.padB.style.top=e.pickerFace+"px";d.padB.style.border=e.pickerInset+"px solid";d.padB.style.borderColor=e.pickerInsetColor;d.padM.style.position="absolute";d.padM.style.left="0";d.padM.style.top="0";d.padM.style.width=e.pickerFace+2*e.pickerInset+jscolor.images.pad[0]+jscolor.images.arrow[0]+
"px";d.padM.style.height=d.box.style.height;d.padM.style.cursor="crosshair";d.sld.style.overflow="hidden";d.sld.style.width=jscolor.images.sld[0]+"px";d.sld.style.height=jscolor.images.sld[1]+"px";d.sldB.style.display=e.slider?"block":"none";d.sldB.style.position="absolute";d.sldB.style.right=e.pickerFace+"px";d.sldB.style.top=e.pickerFace+"px";d.sldB.style.border=e.pickerInset+"px solid";d.sldB.style.borderColor=e.pickerInsetColor;d.sldM.style.display=e.slider?"block":"none";d.sldM.style.position=
"absolute";d.sldM.style.right="0";d.sldM.style.top="0";d.sldM.style.width=jscolor.images.sld[0]+jscolor.images.arrow[0]+e.pickerFace+2*e.pickerInset+"px";d.sldM.style.height=d.box.style.height;try{d.sldM.style.cursor="pointer"}catch(j){d.sldM.style.cursor="hand"}d.btn.style.display=e.pickerClosable?"block":"none";d.btn.style.position="absolute";d.btn.style.left=e.pickerFace+"px";d.btn.style.bottom=e.pickerFace+"px";d.btn.style.padding="0 15px";d.btn.style.height="18px";d.btn.style.border=e.pickerInset+
"px solid";(function(){var c=e.pickerInsetColor.split(/\s+/);d.btn.style.borderColor=2>c.length?c[0]:c[1]+" "+c[0]+" "+c[0]+" "+c[1]})();d.btn.style.color=e.pickerButtonColor;d.btn.style.font="12px sans-serif";d.btn.style.textAlign="center";try{d.btn.style.cursor="pointer"}catch(g){d.btn.style.cursor="hand"}d.btn.onmousedown=function(){e.hidePicker()};d.btnS.style.lineHeight=d.btn.style.height;switch(m){case 0:var i="hs.png";break;case 1:i="hv.png"}d.padM.style.backgroundImage="url('"+jscolor.getDir()+
"cross.gif')";d.padM.style.backgroundRepeat="no-repeat";d.sldM.style.backgroundImage="url('"+jscolor.getDir()+"arrow.gif')";d.sldM.style.backgroundRepeat="no-repeat";d.pad.style.backgroundImage="url('"+jscolor.getDir()+i+"')";d.pad.style.backgroundRepeat="no-repeat";d.pad.style.backgroundPosition="0 0";A();B();jscolor.picker.owner=e;document.getElementsByTagName("body")[0].appendChild(d.boxB)}function x(c){return[2*c.pickerInset+2*c.pickerFace+jscolor.images.pad[0]+(c.slider?2*c.pickerInset+2*jscolor.images.arrow[0]+
jscolor.images.sld[0]:0),c.pickerClosable?4*c.pickerInset+3*c.pickerFace+jscolor.images.pad[1]+c.pickerButtonHeight:2*c.pickerInset+2*c.pickerFace+jscolor.images.pad[1]]}function A(){switch(m){case 0:var c=1;break;case 1:c=2}var b=Math.round(e.hsv[0]/6*(jscolor.images.pad[0]-1)),c=Math.round((1-e.hsv[c])*(jscolor.images.pad[1]-1));jscolor.picker.padM.style.backgroundPosition=e.pickerFace+e.pickerInset+b-Math.floor(jscolor.images.cross[0]/2)+"px "+(e.pickerFace+e.pickerInset+c-Math.floor(jscolor.images.cross[1]/
2))+"px";b=jscolor.picker.sld.childNodes;switch(m){case 0:for(var k=a(e.hsv[0],e.hsv[1],1),c=0;c<b.length;c+=1)b[c].style.backgroundColor="rgb("+100*k[0]*(1-c/b.length)+"%,"+100*k[1]*(1-c/b.length)+"%,"+100*k[2]*(1-c/b.length)+"%)";break;case 1:var f,d=[e.hsv[2],0,0],c=Math.floor(e.hsv[0]),j=c%2?e.hsv[0]-c:1-(e.hsv[0]-c);switch(c){case 6:case 0:k=[0,1,2];break;case 1:k=[1,0,2];break;case 2:k=[2,0,1];break;case 3:k=[2,1,0];break;case 4:k=[1,2,0];break;case 5:k=[0,2,1]}for(c=0;c<b.length;c+=1)f=1-1/
(b.length-1)*c,d[1]=d[0]*(1-f*j),d[2]=d[0]*(1-f),b[c].style.backgroundColor="rgb("+100*d[k[0]]+"%,"+100*d[k[1]]+"%,"+100*d[k[2]]+"%)"}}function B(){switch(m){case 0:var c=2;break;case 1:c=1}c=Math.round((1-e.hsv[c])*(jscolor.images.sld[1]-1));jscolor.picker.sldM.style.backgroundPosition="0 "+(e.pickerFace+e.pickerInset+c-Math.floor(jscolor.images.arrow[1]/2))+"px"}function t(){return jscolor.picker&&jscolor.picker.owner===e}function C(){h!==b&&e.importColor()}function y(c){var b=jscolor.getRelMousePos(c),
c=b.x-e.pickerFace-e.pickerInset,b=b.y-e.pickerFace-e.pickerInset;switch(m){case 0:e.fromHSV(c*(6/(jscolor.images.pad[0]-1)),1-b/(jscolor.images.pad[1]-1),null,u);break;case 1:e.fromHSV(c*(6/(jscolor.images.pad[0]-1)),null,1-b/(jscolor.images.pad[1]-1),u)}}function z(c){c=jscolor.getRelMousePos(c).y-e.pickerFace-e.pickerInset;switch(m){case 0:e.fromHSV(null,null,1-c/(jscolor.images.sld[1]-1),v);break;case 1:e.fromHSV(null,1-c/(jscolor.images.sld[1]-1),null,v)}}function s(){if(e.onImmediateChange)if("string"===
typeof e.onImmediateChange)eval(e.onImmediateChange);else e.onImmediateChange(e)}this.adjust=this.required=!0;this.hash=!1;this.slider=this.caps=!0;this.styleElement=this.valueElement=b;this.onImmediateChange=null;this.hsv=[0,0,1];this.rgb=[1,1,1];this.pickerOnfocus=!0;this.pickerMode="HSV";this.pickerPosition="bottom";this.pickerSmartPosition=!0;this.pickerButtonHeight=20;this.pickerClosable=!1;this.pickerCloseText="Close";this.pickerButtonColor="ButtonText";this.pickerFace=10;this.pickerFaceColor=
"ThreeDFace";this.pickerBorder=1;this.pickerBorderColor="ThreeDHighlight ThreeDShadow ThreeDShadow ThreeDHighlight";this.pickerInset=1;this.pickerInsetColor="ThreeDShadow ThreeDHighlight ThreeDHighlight ThreeDShadow";this.pickerZIndex=1E4;for(var n in f)f.hasOwnProperty(n)&&(this[n]=f[n]);this.hidePicker=function(){t()&&(delete jscolor.picker.owner,document.getElementsByTagName("body")[0].removeChild(jscolor.picker.boxB))};this.showPicker=function(){if(!t()){var c=jscolor.getElementPos(b),a=jscolor.getElementSize(b),
e=jscolor.getViewPos(),f=jscolor.getViewSize(),d=x(this),j,g,i;switch(this.pickerPosition.toLowerCase()){case "left":j=1;g=0;i=-1;break;case "right":j=1;g=0;i=1;break;case "top":j=0;g=1;i=-1;break;default:j=0,i=g=1}var h=(a[g]+d[g])/2,c=this.pickerSmartPosition?[-e[j]+c[j]+d[j]>f[j]?-e[j]+c[j]+a[j]/2>f[j]/2&&0<=c[j]+a[j]-d[j]?c[j]+a[j]-d[j]:c[j]:c[j],-e[g]+c[g]+a[g]+d[g]-h+h*i>f[g]?-e[g]+c[g]+a[g]/2>f[g]/2&&0<=c[g]+a[g]-h-h*i?c[g]+a[g]-h-h*i:c[g]+a[g]-h+h*i:0<=c[g]+a[g]-h+h*i?c[g]+a[g]-h+h*i:c[g]+
a[g]-h-h*i]:[c[j],c[g]+a[g]-h+h*i];l(c[j],c[g])}};this.importColor=function(){h?this.adjust?!this.required&&/^\s*$/.test(h.value)?(h.value="",i.style.backgroundColor=i.jscStyle.backgroundColor,i.style.color=i.jscStyle.color,this.exportColor(r|w)):this.fromString(h.value)||this.exportColor():this.fromString(h.value,r)||(i.style.backgroundColor=i.jscStyle.backgroundColor,i.style.color=i.jscStyle.color,this.exportColor(r|w)):this.exportColor()};this.exportColor=function(c){if(!(c&r)&&h){var a=this.toString();
this.caps&&(a=a.toUpperCase());this.hash&&(a="#"+a);h.value=a}!(c&w)&&i&&(i.style.backgroundColor="#"+this.toString(),i.style.color=0.5>0.213*this.rgb[0]+0.715*this.rgb[1]+0.072*this.rgb[2]?"#FFF":"#000");!(c&v)&&t()&&A();!(c&u)&&t()&&B()};this.fromHSV=function(c,b,e,f){0>c&&(c=0)||6<c&&(c=6);0>b&&(b=0)||1<b&&(b=1);0>e&&(e=0)||1<e&&(e=1);this.rgb=a(null===c?this.hsv[0]:this.hsv[0]=c,null===b?this.hsv[1]:this.hsv[1]=b,null===e?this.hsv[2]:this.hsv[2]=e);this.exportColor(f)};this.fromRGB=function(c,
a,b,e){0>c&&(c=0)||1<c&&(c=1);0>a&&(a=0)||1<a&&(a=1);0>b&&(b=0)||1<b&&(b=1);var c=null===c?this.rgb[0]:this.rgb[0]=c,a=null===a?this.rgb[1]:this.rgb[1]=a,d=null===b?this.rgb[2]:this.rgb[2]=b,f=Math.min(Math.min(c,a),d),b=Math.max(Math.max(c,a),d),g=b-f;0===g?c=[null,0,b]:(c=c===f?3+(d-a)/g:a===f?5+(c-d)/g:1+(a-c)/g,c=[6===c?0:c,g/b,b]);null!==c[0]&&(this.hsv[0]=c[0]);0!==c[2]&&(this.hsv[1]=c[1]);this.hsv[2]=c[2];this.exportColor(e)};this.fromString=function(a,b){var e=a.match(/^\W*([0-9A-F]{3}([0-9A-F]{3})?)\W*$/i);
return e?(6===e[1].length?this.fromRGB(parseInt(e[1].substr(0,2),16)/255,parseInt(e[1].substr(2,2),16)/255,parseInt(e[1].substr(4,2),16)/255,b):this.fromRGB(parseInt(e[1].charAt(0)+e[1].charAt(0),16)/255,parseInt(e[1].charAt(1)+e[1].charAt(1),16)/255,parseInt(e[1].charAt(2)+e[1].charAt(2),16)/255,b),!0):!1};this.toString=function(){return(256|Math.round(255*this.rgb[0])).toString(16).substr(1)+(256|Math.round(255*this.rgb[1])).toString(16).substr(1)+(256|Math.round(255*this.rgb[2])).toString(16).substr(1)};
var e=this,m="hvs"===this.pickerMode.toLowerCase()?1:0,o=!1,h=jscolor.fetchElement(this.valueElement),i=jscolor.fetchElement(this.styleElement),p=!1,q=!1,r=1,w=2,v=4,u=8;jscolor.addEvent(b,"focus",function(){e.pickerOnfocus&&e.showPicker()});jscolor.addEvent(b,"blur",function(){o?o=!1:window.setTimeout(function(){o||(h===b&&e.importColor(),e.pickerOnfocus&&e.hidePicker());o=!1},0)});h&&(n=function(){e.fromString(h.value,r);s()},jscolor.addEvent(h,"keyup",n),jscolor.addEvent(h,"input",n),jscolor.addEvent(h,
"blur",C),h.setAttribute("autocomplete","off"));i&&(i.jscStyle={backgroundColor:i.style.backgroundColor,color:i.style.color});switch(m){case 0:jscolor.requireImage("hs.png");break;case 1:jscolor.requireImage("hv.png")}jscolor.requireImage("cross.gif");jscolor.requireImage("arrow.gif");this.importColor()}};exports=jscolor;
