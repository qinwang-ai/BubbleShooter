1cfa7641fb53f7bc88af5f83a0cd4894
jsio("import lib.PubSub");jsio("import .Widget");jsio("import .Delegate");jsio("from util.browser import $");
var Users_tsunami_projects_devkitPoj_BubbleShooter_modules_devkit_core_modules_squill_Menu=__class__,Menu=exports=Users_tsunami_projects_devkitPoj_BubbleShooter_modules_devkit_core_modules_squill_Menu(function(){return this.init&&this.init.apply(this,arguments)},Widget,function(){this._css="menu";this._def={children:[{id:"container"}]};this.delegate=new Delegate(function(a){a.call=function(a,d){var c=a.controller.delegate;c.call.apply(c,[a.controller].concat(Array.prototype.slice.call(arguments,1)))}});
this.getContainer=function(){return this.container};this.onBeforeShow=function(){};this.onShow=function(){};this.onBeforeHide=function(){};this.onHide=function(){};this.toggle=function(){this._isShowing?this.hide():this.show()};this.show=function(){this._isShowing=!0;var a=this._el,b=bind(this,function(c){for(var b=c.target;b;){if(b==a)return!0;if(/squill-checkbox/.test(b.className))return!1;b=b.parentNode}c.preventDefault&&c.preventDefault();c.stopImmediatePropagation&&c.stopImmediatePropagation();
c.stopPropagation&&c.stopPropagation();return c.cancelBubble=!0}),d=bind(this,function(a){b(a)&&(this.hide(),untrapIframes(),document.body.removeEventListener("mousedown",b,!0),document.body.removeEventListener("mouseup",b,!0),document.body.removeEventListener("click",d,!0))});trapIframes();document.body.addEventListener("mousedown",b,!0);document.body.addEventListener("mouseup",b,!0);document.body.addEventListener("click",d,!0);$.show(a);this.emit("open");Menu.emit("open",this)};this.hide=function(){this._isShowing=
!1;$.hide(this._el);this.emit("close");Menu.emit("close",this)}}),subs=new lib.PubSub;Menu.emit=bind(subs,"emit");Menu.on=bind(subs,"on");Menu.removeListener=bind(subs,"removeListener");var _trappedFrames=[];function trapIframes(){_trappedFrames.length&&untrapIframes();_trappedFrames=Array.prototype.map.call(document.getElementsByTagName("iframe"),function(a){var b={el:a,set:a.style.pointerEvents};a.style.pointerEvents="none";return b})}
function untrapIframes(){_trappedFrames.forEach(function(a){a.el.style.pointerEvents=a.set})};
