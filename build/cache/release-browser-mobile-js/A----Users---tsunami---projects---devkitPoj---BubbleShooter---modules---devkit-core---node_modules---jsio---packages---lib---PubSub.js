ad298ca89753c3ff72609618ec63b26f
jsio("from ..std.uuid import uuid");var ctx=jsio.__env.global,SLICE=Array.prototype.slice,Users_tsunami_projects_devkitPoj_BubbleShooter_modules_devkit_core_node_modules_jsio_packages_lib_PubSub=__class__;
exports=Users_tsunami_projects_devkitPoj_BubbleShooter_modules_devkit_core_node_modules_jsio_packages_lib_PubSub(function(){return this.init&&this.init.apply(this,arguments)},function(){this.init=function(){};this.publish=function(a){if(this._subscribers){var b=SLICE.call(arguments,1);if(this._subscribers.__any)for(var e=[a].concat(b),d=this._subscribers.__any.slice(0),c=0,f;f=d[c];++c)f.apply(ctx,e);if(!this._subscribers[a])return this;d=this._subscribers[a].slice(0);for(c=0;f=d[c];++c)f.apply(ctx,
b)}return this};this.subscribe=function(a,b,e){var d;2==arguments.length?d=b:(d=bind.apply(GLOBAL,SLICE.call(arguments,1)),d._ctx=b,d._method=e);var c=this._subscribers||(this._subscribers={});(c[a]||(c[a]=[])).push(d);return this};this.subscribeOnce=function(a,b,e){var d=arguments,c=bind(this,function(){this.unsubscribe(a,c);2==d.length?b.apply(GLOBAL,arguments):bind.apply(GLOBAL,SLICE.call(d,1)).apply(GLOBAL,arguments)});3<=d.length&&(c._ctx=b,c._method=e);return this.subscribe(a,c)};this.unsubscribe=
function(a,b,e){if(!this._subscribers||!this._subscribers[a])return this;for(var a=this._subscribers[a],d=0,c;c=a[d];++d)(c==b||c._ctx==b&&(!e||c._method==e))&&a.splice(d--,1);return this};this.listeners=function(a){this._subscribers=this._subscribers?this._subscribers:{};return this.hasOwnProperty.call(this._subscribers,a)?this._subscribers[a]:this._subscribers[a]=[]};this.addListener=this.on=function(a,b){this.listeners(a).length+1>this._maxListeners&&0!==this._maxListeners&&"undefined"!==typeof console&&
console.warn("Possible EventEmitter memory leak detected. "+this._subscribers[a].length+" listeners added. Use emitter.setMaxListeners() to increase limit.");this.emit("newListener",a,b);return this.subscribe(a,this,b)};this.once=function(a,b){return this.subscribeOnce(a,this,b)};this.removeListener=function(a,b){this.unsubscribe(a,this,b);return this};this.removeAllListeners=function(a){if(this._subscribers)for(var b in this._subscribers)(null==a||a==b)&&delete this._subscribers[b];return this};
this.emit=function(a){this.publish.apply(this,arguments);return 0<this.listeners(a).length};this._maxListeners=10;this.setMaxListeners=function(a){this._maxListeners=a};this.hasListeners=function(a){return this._subscribers&&this._subscribers[a]&&this._subscribers[a].length};this.listenTo=function(a,b,e){var d=this._listeningTo||(this._listeningTo={}),c=a._listenId||(a._listenId=uuid(8,16));d[c]=a;a.subscribe(b,this,e);return this};this.stopListening=function(a,b,e){var d,c,f,g,h,k,l,i,j=this._listeningTo;
if(!j)return this;logger.LOG&&console.log("LOG","lib.PubSub",a);var n=!b&&!e;a&&((j={})[a._listenId]=a);for(var m in j){a=j[m];c=b?[b]:Object.keys(a._subscribers);g=0;for(l=c.length;g<l;g++)if(b=c[g],d=a._subscribers[b]){a._subscribers[b]=f=[];h=0;for(k=d.length;h<k;h++)i=d[h],(e&&e!==i._method||this&&this!==i._ctx)&&f.push(i);f.length||delete a._subscribers[b]}n&&delete this._listeningTo[m]}return this}});
