2e739c26f48ca50c82a4cf9f8f98eea8
!function(x){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=x();else if("function"==typeof define&&define.amd)define([],x);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self);e.Promise=x()}}(function(){return function e(k,a,g){function f(b,n){if(!a[b]){if(!k[b]){var l="function"==typeof _dereq_&&_dereq_;if(!n&&l)return l(b,!0);if(i)return i(b,!0);l=Error("Cannot find module '"+b+"'");throw l.code="MODULE_NOT_FOUND",
l;}l=a[b]={exports:{}};k[b][0].call(l.exports,function(a){var n=k[b][1][a];return f(n?n:a)},l,l.exports,e,k,a,g)}return a[b].exports}for(var i="function"==typeof _dereq_&&_dereq_,j=0;j<g.length;j++)f(g[j]);return f}({1:[function(e,k){function a(){this._isTickUsed=!1;this._lateQueue=new j(16);this._normalQueue=new j(16);var a=this;this.drainQueues=function(){a._drainQueues()};this._schedule=i.isStatic?i(this.drainQueues):i}var g;try{throw Error();}catch(f){g=f}var i=e("./schedule.js"),j=e("./queue.js"),
b="undefined"!==typeof process?process:void 0;a.prototype.haveItemsQueued=function(){return 0<this._normalQueue.length()};a.prototype._withDomain=function(a){void 0!==b&&(null!=b.domain&&!a.domain)&&(a=b.domain.bind(a));return a};a.prototype.throwLater=function(a,b){1===arguments.length&&(b=a,a=function(){throw b;});a=this._withDomain(a);if("undefined"!==typeof setTimeout)setTimeout(function(){a(b)},0);else try{this._schedule(function(){a(b)})}catch(c){throw Error("No async scheduler available\n\n    See http://goo.gl/m3OTXk\n");
}};a.prototype.invokeLater=function(a,b,c){a=this._withDomain(a);this._lateQueue.push(a,b,c);this._queueTick()};a.prototype.invokeFirst=function(a,b,c){a=this._withDomain(a);this._normalQueue.unshift(a,b,c);this._queueTick()};a.prototype.invoke=function(a,b,c){a=this._withDomain(a);this._normalQueue.push(a,b,c);this._queueTick()};a.prototype.settlePromises=function(a){this._normalQueue._pushOne(a);this._queueTick()};a.prototype._drainQueue=function(a){for(;0<a.length();){var b=a.shift();if("function"!==
typeof b)b._settlePromises();else{var c=a.shift(),o=a.shift();b.call(c,o)}}};a.prototype._drainQueues=function(){this._drainQueue(this._normalQueue);this._reset();this._drainQueue(this._lateQueue)};a.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))};a.prototype._reset=function(){this._isTickUsed=!1};k.exports=new a;k.exports.firstLineError=g},{"./queue.js":24,"./schedule.js":26}],2:[function(e,k){k.exports=function(a,g,f){function i(){return this.value}
function j(){throw this.reason;}function b(a){return this._then(i,null,null,{value:a},void 0)}function n(a){return this._then(j,j,null,{reason:a},void 0)}function l(a){this._setBoundTo(a)}a.prototype.bind=function(c){var o=f(c);if(o instanceof a)if(o.isFulfilled())c=o.value();else{if(o.isRejected())return a.reject(o.reason());var m=this.then(),c=m,m=m._then(b,n,null,o,void 0);o._then(l,m._reject,null,m,null);m._cancellable()||m._setPendingCancellationParent(c);return m}m=this.then();m._setBoundTo(c);
return m};a.bind=function(c,b){return a.resolve(b).bind(c)};a.prototype._setPendingCancellationParent=function(a){this._settledValue=a};a.prototype._pendingCancellationParent=function(){if(this.isPending()&&void 0!==this._settledValue){var a=this._settledValue;a.cancellable();this._settledValue=void 0;return a}};a.prototype._setIsMigratingBinding=function(){this._bitField|=8388608};a.prototype._unsetIsMigratingBinding=function(){this._bitField&=-8388609};a.prototype._isMigratingBinding=function(){return 8388608===
(this._bitField&8388608)};a.prototype._setBoundTo=function(a){this._boundTo=a};a.prototype._isBound=function(){return void 0!==this._boundTo}}},{}],3:[function(e,k){var a;"undefined"!==typeof Promise&&(a=Promise);var g=e("./promise.js")();g.noConflict=function(){try{Promise===g&&(Promise=a)}catch(f){}return g};k.exports=g},{"./promise.js":20}],4:[function(e,k){k.exports=function(a){var g=e("./errors.js"),f=e("./async.js"),i=g.CancellationError;a.prototype._cancel=function(a){if(!this.isCancellable())return this;
for(var b,n=this;void 0!==(b=n._cancellationParent)&&b.isCancellable();)n=b;this._unsetCancellable();n._target()._rejectCallback(a,!1,!0)};a.prototype.cancel=function(a){if(!this.isCancellable())return this;void 0===a&&(a=new i);f.invokeLater(this._cancel,this,a);return this};a.prototype.cancellable=function(){if(this._cancellable())return this;this._setCancellable();this._cancellationParent=this._pendingCancellationParent();return this};a.prototype.uncancellable=function(){var a=this.then();a._unsetCancellable();
return a};a.prototype.fork=function(a,b,n){a=this._then(a,b,n,void 0,void 0);a._setCancellable();a._cancellationParent=void 0;return a}}},{"./async.js":1,"./errors.js":11}],5:[function(e,k){k.exports=function(){function a(c){this._parent=c;c=this._length=1+(void 0===c?0:c._length);p(this,a);32<c&&this.uncycle()}function g(a){for(var d=[],c=0;c<a.length;++c){var h=a[c],b=l.test(h)||"    (No stack trace)"===h,q=b&&m(h);b&&!q&&(o&&" "!==h.charAt(0)&&(h="    "+h),d.push(h))}return d}function f(a){var d;
if("function"===typeof a)d="[function "+(a.name||"anonymous")+"]";else{d=a.toString();if(/\[object [a-zA-Z0-9$_]+\]/.test(d))try{d=JSON.stringify(a)}catch(c){}0===d.length&&(d="(empty array)")}a=41>d.length?d:d.substr(0,38)+"...";return"(<"+a+">, no stack trace)"}function i(a){if(a=a.match(t))return{fileName:a[1],line:parseInt(a[2],10)}}var j=e("./async.js"),b=e("./util.js"),n=/[\\\/]bluebird[\\\/]js[\\\/](main|debug|zalgo|instrumented)/,l=null,c=null,o=!1;b.inherits(a,Error);a.prototype.uncycle=
function(){var a=this._length;if(!(2>a)){for(var d=[],c={},h=0,a=this;void 0!==a;++h)d.push(a),a=a._parent;a=this._length=h;for(h=a-1;0<=h;--h){var b=d[h].stack;void 0===c[b]&&(c[b]=h)}for(h=0;h<a;++h)if(b=c[d[h].stack],void 0!==b&&b!==h){0<b&&(d[b-1]._parent=void 0,d[b-1]._length=1);d[h]._parent=void 0;d[h]._length=1;c=0<h?d[h-1]:this;b<a-1?(c._parent=d[b+1],c._parent.uncycle(),c._length=c._parent._length+1):(c._parent=void 0,c._length=1);a=c._length+1;for(h-=2;0<=h;--h)d[h]._length=a,a++;break}}};
a.prototype.parent=function(){return this._parent};a.prototype.hasParent=function(){return void 0!==this._parent};a.prototype.attachExtraTrace=function(c){if(!c.__stackCleaned__){this.uncycle();for(var d=a.parseStackAndMessage(c),b=d.message,d=[d.stack],h=this;void 0!==h;)d.push(g(h.stack.split("\n"))),h=h._parent;for(var h=d[0],o=1;o<d.length;++o){for(var q=d[o],s=h.length-1,n=h[s],m=-1,f=q.length-1;0<=f;--f)if(q[f]===n){m=f;break}for(f=m;0<=f;--f)if(h[s]===q[f])h.pop(),s--;else break;h=q}for(h=
0;h<d.length;++h)if(0===d[h].length||h+1<d.length&&d[h][0]===d[h+1][0])d.splice(h,1),h--;for(h=0;h<d.length-1;++h)d[h].push("From previous event:"),d[h]=d[h].join("\n");h<d.length&&(d[h]=d[h].join("\n"));b=b+"\n"+d.join("\n");c.stack=b;c.__stackCleaned__=!0}};a.parseStackAndMessage=function(a){var d=a.stack,c=a.toString();if("string"===typeof d&&0<d.length){a=a.stack.replace(/\s+$/g,"").split("\n");for(d=0;d<a.length;++d){var b=a[d];if("    (No stack trace)"===b||l.test(b))break}0<d&&(a=a.slice(d))}else a=
["    (No stack trace)"];return{message:c,stack:g(a)}};a.formatAndLogError=function(a,d){if("object"===typeof console){var b;b="object"===typeof a||"function"===typeof a?d+c(a.stack,a):d+(""+a);"function"===typeof console.warn||"object"===typeof console.warn?console.warn(b):("function"===typeof console.log||"object"===typeof console.log)&&console.log(b)}};a.unhandledRejection=function(c){a.formatAndLogError(c,"^--- With additional stack trace: ")};a.isSupported=function(){return"function"===typeof p};
a.fireRejectionEvent=function(c,d,b,h){var o=!1;try{"function"===typeof d&&(o=!0,"rejectionHandled"===c?d(h):d(b,h))}catch(q){j.throwLater(q)}d=!1;try{d=r(c,b,h)}catch(s){d=!0,j.throwLater(s)}var m=!1;if(u)try{m=u(c.toLowerCase(),{reason:b,promise:h})}catch(n){m=!0,j.throwLater(n)}!d&&(!o&&!m&&"unhandledRejection"===c)&&a.formatAndLogError(b,"Possibly unhandled ")};var m=function(){return!1},t=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;a.setBounds=function(c,d){if(a.isSupported()){for(var b=c.stack.split("\n"),
h=d.stack.split("\n"),o=-1,q=-1,s,f,g=0;g<b.length;++g){var l=i(b[g]);if(l){s=l.fileName;o=l.line;break}}for(g=0;g<h.length;++g)if(l=i(h[g])){f=l.fileName;q=l.line;break}0>o||(0>q||!s||!f||s!==f||o>=q)||(m=function(a){return n.test(a)?!0:(a=i(a))&&a.fileName===s&&o<=a.line&&a.line<=q?!0:!1})}};var p=function(){var a=/^\s*at\s*/,d=function(a,d){return"string"===typeof a?a:void 0!==d.name&&void 0!==d.message?d.toString():f(d)};if("number"===typeof Error.stackTraceLimit&&"function"===typeof Error.captureStackTrace){Error.stackTraceLimit+=
6;l=a;c=d;var b=Error.captureStackTrace;m=function(a){return n.test(a)};return function(a,d){Error.stackTraceLimit+=6;b(a,d);Error.stackTraceLimit-=6}}var h=Error();if("string"===typeof h.stack&&0<=h.stack.split("\n")[0].indexOf("stackDetection@"))return l=/@/,c=d,o=!0,function(a){a.stack=Error().stack};try{throw Error();}catch(g){}if(!("stack"in h)&&"stack"in g)return l=a,c=d,function(a){Error.stackTraceLimit+=6;try{throw Error();}catch(d){a.stack=d.stack}Error.stackTraceLimit-=6};c=function(a,d){return"string"===
typeof a?a:("object"===typeof d||"function"===typeof d)&&void 0!==d.name&&void 0!==d.message?d.toString():f(d)};return null}([]),u,r=function(){if(b.isNode)return function(a,d,q){return"rejectionHandled"===a?process.emit(a,q):process.emit(a,d,q)};var a=!1,d=!0;try{a=new self.CustomEvent("test")instanceof CustomEvent}catch(c){}if(!a)try{var h=document.createEvent("CustomEvent");h.initCustomEvent("testingtheevent",!1,!0,{});self.dispatchEvent(h)}catch(o){d=!1}d&&(u=function(d,q){var c;a?c=new self.CustomEvent(d,
{detail:q,bubbles:!1,cancelable:!0}):self.dispatchEvent&&(c=document.createEvent("CustomEvent"),c.initCustomEvent(d,!1,!0,q));return c?!self.dispatchEvent(c):!1});var q={unhandledRejection:"onunhandledrejection",rejectionHandled:"onrejectionhandled"};return function(a,d,c){var b=self[q[a]];if(!b)return!1;"rejectionHandled"===a?b.call(self,c):b.call(self,d,c);return!0}}();return a}},{"./async.js":1,"./util.js":30}],6:[function(e,k){k.exports=function(a){function g(a,b,m){this._instances=a;this._callback=
b;this._promise=m}var f=e("./util.js"),i=e("./errors.js"),j=f.tryCatch,b=f.errorObj,n=e("./es5.js").keys,l=i.TypeError;g.prototype.doFilter=function(c){for(var o=this._callback,m=this._promise._boundTo,f=0,g=this._instances.length;f<g;++f){var i=this._instances[f],r=i===Error||null!=i&&i.prototype instanceof Error;if(r&&c instanceof i)return c=j(o).call(m,c),c===b?(a.e=c.e,a):c;if("function"===typeof i&&!r){var e=c,r={},i=j(i).call(r,e);i!==b&&n(r).length&&(b.e=new l("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n"),
i=b);if(i===b){c=b.e;break}else if(i)return c=j(o).call(m,c),c===b?(a.e=c.e,a):c}}a.e=c;return a};return g}},{"./errors.js":11,"./es5.js":12,"./util.js":30}],7:[function(e,k){k.exports=function(a,g,f){function i(){this._trace=new g(j())}function j(){var a=b.length-1;if(0<=a)return b[a]}var b=[];i.prototype._pushContext=function(){f()&&void 0!==this._trace&&b.push(this._trace)};i.prototype._popContext=function(){f()&&void 0!==this._trace&&b.pop()};a.prototype._peekContext=j;a.prototype._pushContext=
i.prototype._pushContext;a.prototype._popContext=i.prototype._popContext;return function(){if(f())return new i}}},{}],8:[function(e,k){k.exports=function(a,g){var f=e("./async.js"),i=e("./errors.js").Warning,j=e("./util.js"),b=j.canAttachTrace,n,l,c=j.isNode&&(!!process.env.BLUEBIRD_DEBUG||"development"===process.env.NODE_ENV);a.prototype._ensurePossibleRejectionHandled=function(){this._setRejectionIsUnhandled();f.invokeLater(this._notifyUnhandledRejection,this,void 0)};a.prototype._notifyUnhandledRejectionIsHandled=
function(){g.fireRejectionEvent("rejectionHandled",n,void 0,this)};a.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var a=this._getCarriedStackTrace()||this._settledValue;this._setUnhandledRejectionIsNotified();g.fireRejectionEvent("unhandledRejection",l,a,this)}};a.prototype._setUnhandledRejectionIsNotified=function(){this._bitField|=524288};a.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField&=-524289};a.prototype._isUnhandledRejectionNotified=
function(){return 0<(this._bitField&524288)};a.prototype._setRejectionIsUnhandled=function(){this._bitField|=2097152};a.prototype._unsetRejectionIsUnhandled=function(){this._bitField&=-2097153;this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())};a.prototype._isRejectionUnhandled=function(){return 0<(this._bitField&2097152)};a.prototype._setCarriedStackTrace=function(a){this._bitField|=1048576;this._fulfillmentHandler0=a};a.prototype._isCarryingStackTrace=
function(){return 0<(this._bitField&1048576)};a.prototype._getCarriedStackTrace=function(){return this._isCarryingStackTrace()?this._fulfillmentHandler0:void 0};a.prototype._captureStackTrace=function(){c&&(this._trace=new g(this._peekContext()));return this};a.prototype._attachExtraTrace=function(a,m){if(c&&b(a)){var f=this._trace;void 0!==f&&m&&(f=f._parent);void 0!==f?f.attachExtraTrace(a):a.__stackCleaned__||(f=g.parseStackAndMessage(a),a.stack=f.stack.join("\n"),a.__stackCleaned__=!0)}};a.prototype._warn=
function(a){var a=new i(a),c=this._peekContext();c?c.attachExtraTrace(a):(c=g.parseStackAndMessage(a),a.stack=c.message+"\n"+c.stack.join("\n"));g.formatAndLogError(a,"")};a.onPossiblyUnhandledRejection=function(a){l="function"===typeof a?a:void 0};a.onUnhandledRejectionHandled=function(a){n="function"===typeof a?a:void 0};a.longStackTraces=function(){if(f.haveItemsQueued()&&!1===c)throw Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/DT1qyG\n");c=
g.isSupported()};a.hasLongStackTraces=function(){return c&&g.isSupported()};g.isSupported()||(a.longStackTraces=function(){},c=!1);return function(){return c}}},{"./async.js":1,"./errors.js":11,"./util.js":30}],9:[function(e,k){var a=e("./util.js"),g=a.isPrimitive,f=a.wrapsPrimitiveReceiver;k.exports=function(a){var j=function(){return this},b=function(){throw this;},n=function(a,c){if(1===c)return function(){throw a;};if(2===c)return function(){return a}};a.prototype["return"]=a.prototype.thenReturn=
function(a){return f&&g(a)?this._then(n(a,2),void 0,void 0,void 0,void 0):this._then(j,void 0,void 0,a,void 0)};a.prototype["throw"]=a.prototype.thenThrow=function(a){return f&&g(a)?this._then(n(a,1),void 0,void 0,void 0,void 0):this._then(b,void 0,void 0,a,void 0)}}},{"./util.js":30}],10:[function(e,k){k.exports=function(a,g){var f=a.reduce;a.prototype.each=function(a){return f(this,a,null,g)};a.each=function(a,j){return f(a,j,null,g)}}},{}],11:[function(e,k){function a(a,d){function c(h){if(!(this instanceof
c))return new c(h);b(this,"message","string"===typeof h?h:d);b(this,"name",a);Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}j(c,Error);return c}function g(a){if(!(this instanceof g))return new g(a);b(this,"name","OperationalError");b(this,"message",a);this.cause=a;this.isOperational=!0;a instanceof Error?(b(this,"message",a.message),b(this,"stack",a.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}var f=e("./es5.js").freeze,
i=e("./util.js"),j=i.inherits,b=i.notEnumerableProp,n,l,i=a("Warning","warning"),c=a("CancellationError","cancellation error"),o=a("TimeoutError","timeout error"),m=a("AggregateError","aggregate error");try{n=TypeError,l=RangeError}catch(t){n=a("TypeError","type error"),l=a("RangeError","range error")}for(var p="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),u=0;u<p.length;++u)"function"===typeof Array.prototype[p[u]]&&
(m.prototype[p[u]]=Array.prototype[p[u]]);m.prototype.length=0;m.prototype.isOperational=!0;var r=0;m.prototype.toString=function(){var a=Array(4*r+1).join(" "),d="\n"+a+"AggregateError of:\n";r++;for(var a=Array(4*r+1).join(" "),c=0;c<this.length;++c){for(var b=this[c]===this?"[Circular AggregateError]":this[c]+"",b=b.split("\n"),f=0;f<b.length;++f)b[f]=a+b[f];b=b.join("\n");d+=b+"\n"}r--;return d};j(g,Error);p=Error.__BluebirdErrorTypes__;p||(p=f({CancellationError:c,TimeoutError:o,OperationalError:g,
RejectionError:g,AggregateError:m}),b(Error,"__BluebirdErrorTypes__",p));k.exports={Error:Error,TypeError:n,RangeError:l,CancellationError:p.CancellationError,OperationalError:p.OperationalError,TimeoutError:p.TimeoutError,AggregateError:p.AggregateError,Warning:i}},{"./es5.js":12,"./util.js":30}],12:[function(e,k){var a=function(){return void 0===this}();if(a)k.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,keys:Object.keys,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,
isES5:a,propertyIsWritable:function(a,b){var f=Object.getOwnPropertyDescriptor(a,b);return!(f&&!f.writable&&!f.set)}};else{var g={}.hasOwnProperty,f={}.toString,i={}.constructor.prototype;k.exports={isArray:function(a){try{return"[object Array]"===f.call(a)}catch(b){return!1}},keys:function(a){var b=[],f;for(f in a)g.call(a,f)&&b.push(f);return b},defineProperty:function(a,b,f){a[b]=f.value;return a},freeze:function(a){return a},getPrototypeOf:function(a){try{return Object(a).constructor.prototype}catch(b){return i}},
isES5:a,propertyIsWritable:function(){return!0}}}},{}],13:[function(e,k){k.exports=function(a,g){var f=a.map;a.prototype.filter=function(a,e){return f(this,a,e,g)};a.filter=function(a,e,b){return f(a,e,b,g)}}},{}],14:[function(e,k){k.exports=function(a,g,f){function i(){return this}function j(){throw this;}function b(a){return function(){return a}}function n(a){return function(){throw a;}}function l(a,c,d){d=t&&p(c)?d?b(c):n(c):d?i:j;return a._then(d,u,void 0,c,void 0)}function c(c){var b=this.promise,
d=this.handler,d=b._isBound()?d.call(b._boundTo):d();return void 0!==d&&(d=f(d,b),d instanceof a)?(d=d._target(),l(d,c,b.isFulfilled())):b.isRejected()?(g.e=c,g):c}function o(c){var b=this.promise,d=this.handler,d=b._isBound()?d.call(b._boundTo,c):d(c);return void 0!==d&&(b=f(d,b),b instanceof a)?(b=b._target(),l(b,c,!0)):c}var m=e("./util.js"),t=m.wrapsPrimitiveReceiver,p=m.isPrimitive,u=m.thrower;a.prototype._passThroughHandler=function(a,b){return"function"!==typeof a?this.then():this._then(b?
c:o,b?c:void 0,void 0,{promise:this,handler:a},void 0)};a.prototype.lastly=a.prototype["finally"]=function(a){return this._passThroughHandler(a,!0)};a.prototype.tap=function(a){return this._passThroughHandler(a,!1)}}},{"./util.js":30}],15:[function(e,k){k.exports=function(a,g){e("./util.js");a.join=function(){var a;a=arguments.length-1;var e;0<a&&"function"===typeof arguments[a]&&(e=arguments[a]);a=arguments.length;for(var j=Array(a),b=0;b<a;++b)j[b]=arguments[b];e&&j.pop();a=(new g(j)).promise();
return void 0!==e?a.spread(e):a}}},{"./util.js":30}],16:[function(e,k){k.exports=function(a,g,f,i,j){function b(a,c,b,f){this.constructor$(a);this._promise._setIsSpreadable();this._promise._captureStackTrace();this._callback=c;this._preservedValues=f===j?Array(this.length()):null;this._limit=b;this._inFlight=0;this._queue=1<=b?[]:t;this._init$(void 0,-2)}function n(a,c,f,g){f="object"===typeof f&&null!==f?f.concurrency:0;f="number"===typeof f&&isFinite(f)&&1<=f?f:0;return new b(a,c,f,g)}var l=e("./util.js"),
c=l.tryCatch,o=l.errorObj,m={},t=[];l.inherits(b,g);b.prototype._init=function(){};b.prototype._promiseFulfilled=function(b,f){var g=this._values,n=this.length(),d=this._preservedValues,e=this._limit;if(g[f]===m){if(g[f]=b,1<=e&&(this._inFlight--,this._drainQueue(),this._isResolved()))return}else{if(1<=e&&this._inFlight>=e){g[f]=b;this._queue.push(f);return}null!==d&&(d[f]=b);var h=this._callback,l=this._promise._boundTo;this._promise._pushContext();h=c(h).call(l,b,f,n);this._promise._popContext();
if(h===o)return this._reject(h.e);l=i(h,this._promise);if(l instanceof a){l=l._target();if(l._isPending())return 1<=e&&this._inFlight++,g[f]=m,l._proxyPromiseArray(this,f);if(l._isFulfilled())h=l._value();else return this._reject(l._reason())}g[f]=h}++this._totalResolved>=n&&(null!==d?this._filter(g,d):this._resolve(g))};b.prototype._drainQueue=function(){for(var a=this._queue,c=this._limit,b=this._values;0<a.length&&this._inFlight<c&&!this._isResolved();){var f=a.pop();this._promiseFulfilled(b[f],
f)}};b.prototype._filter=function(a,c){for(var b=c.length,f=Array(b),d=0,g=0;g<b;++g)a[g]&&(f[d++]=c[g]);f.length=d;this._resolve(f)};b.prototype.preservedValues=function(){return this._preservedValues};a.prototype.map=function(a,c){return"function"!==typeof a?f("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):n(this,a,c,null).promise()};a.map=function(a,c,b,g){return"function"!==typeof c?f("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):n(a,c,b,g).promise()}}},{"./util.js":30}],
17:[function(e,k){k.exports=function(a,g,f,i){var j=e("./util.js"),b=j.tryCatch;a.method=function(f){if("function"!==typeof f)throw new a.TypeError("fn must be a function\n\n    See http://goo.gl/916lJJ\n");return function(){var e=new a(g);e._captureStackTrace();e._pushContext();var c=b(f).apply(this,arguments);e._popContext();e._resolveFromSyncValue(c);return e}};a.attempt=a["try"]=function(f,e,c){if("function"!==typeof f)return i("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var o=
new a(g);o._captureStackTrace();o._pushContext();f=j.isArray(e)?b(f).apply(c,e):b(f).call(c,e);o._popContext();o._resolveFromSyncValue(f);return o};a.prototype._resolveFromSyncValue=function(a){a===j.errorObj?this._rejectCallback(a.e,!1,!0):this._resolveCallback(a,!0)}}},{"./util.js":30}],18:[function(e,k){k.exports=function(a){function g(a,g){if(!j.isArray(a))return f.call(this,a,g);var m=n(g).apply(this._boundTo,[null].concat(a));m===l&&b.throwLater(m.e)}function f(a,f){var g=this._boundTo,g=void 0===
a?n(f).call(g,null):n(f).call(g,null,a);g===l&&b.throwLater(g.e)}function i(a,f){if(!a){var g=this._target()._getCarriedStackTrace();g.cause=a;a=g}g=n(f).call(this._boundTo,a);g===l&&b.throwLater(g.e)}var j=e("./util.js"),b=e("./async.js"),n=j.tryCatch,l=j.errorObj;a.prototype.nodeify=function(a,b){if("function"==typeof a){var e=f;void 0!==b&&Object(b).spread&&(e=g);this._then(e,i,void 0,this,a)}return this}}},{"./async.js":1,"./util.js":30}],19:[function(e,k){k.exports=function(a,g){var f=e("./util.js"),
i=e("./async.js"),j=f.tryCatch,b=f.errorObj;a.prototype.progressed=function(a){return this._then(void 0,void 0,a,void 0,void 0)};a.prototype._progress=function(a){this._isFollowingOrFulfilledOrRejected()||this._target()._progressUnchecked(a)};a.prototype._progressHandlerAt=function(a){return 0===a?this._progressHandler0:this[(a<<2)+a-5+2]};a.prototype._doProgressWith=function(g){var e=g.value,c=g.promise,o=g.receiver,g=j(g.handler).call(o,e);g===b?null!=g.e&&"StopProgressPropagation"!==g.e.name&&
(e=f.canAttachTrace(g.e)?g.e:Error(f.toString(g.e)),c._attachExtraTrace(e),c._progress(g.e)):g instanceof a?g._then(c._progress,null,null,c,void 0):c._progress(g)};a.prototype._progressUnchecked=function(b){for(var f=this._length(),c=this._progress,e=0;e<f;e++){var m=this._progressHandlerAt(e),j=this._promiseAt(e);if(j instanceof a)"function"===typeof m?i.invoke(this._doProgressWith,this,{handler:m,promise:j,receiver:this._receiverAt(e),value:b}):i.invoke(c,j,b);else{var p=this._receiverAt(e);"function"===
typeof m?m.call(p,b,j):p instanceof g&&!p._isResolved()&&p._promiseProgressed(b,j)}}}}},{"./async.js":1,"./util.js":30}],20:[function(e,k){k.exports=function(){function a(d){if("function"!==typeof d)throw new l("the promise constructor requires a resolver function\n\n    See http://goo.gl/EC22Yn\n");if(this.constructor!==a)throw new l("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/KsIlge\n");this._bitField=0;this._boundTo=this._settledValue=this._receiver0=this._promise0=
this._progressHandler0=this._rejectionHandler0=this._fulfillmentHandler0=void 0;d!==c&&this._resolveFromResolver(d)}var g=function(){return new l("circular promise resolution chain\n\n    See http://goo.gl/LhFpo0\n")},f=function(){return new a.PromiseInspection(this._target())},i=function(d){return a.reject(new l(d))},j=e("./util.js"),b=e("./async.js"),n=e("./errors.js"),l=a.TypeError=n.TypeError;a.RangeError=n.RangeError;a.CancellationError=n.CancellationError;a.TimeoutError=n.TimeoutError;a.OperationalError=
n.OperationalError;a.RejectionError=n.OperationalError;a.AggregateError=n.AggregateError;var c=function(){},o={},m={e:null},t=e("./thenables.js")(a,c),p=e("./promise_array.js")(a,c,t,i),k=e("./captured_trace.js")(),r=e("./debuggability.js")(a,k);e("./context.js")(a,k,r);var v=e("./catch_filter.js")(m),d=e("./promise_resolver.js"),y=d._nodebackForPromise,h=j.errorObj,w=j.tryCatch;a.prototype.toString=function(){return"[object Promise]"};a.prototype.caught=a.prototype["catch"]=function(d){var c=arguments.length;
if(1<c){var b=Array(c-1),f=0,g;for(g=0;g<c-1;++g){var h=arguments[g];if("function"===typeof h)b[f++]=h;else return a.reject(new l("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n"))}b.length=f;d=arguments[g];c=new v(b,d,this);return this._then(void 0,c.doFilter,void 0,c,void 0)}return this._then(void 0,d,void 0,void 0,void 0)};a.prototype.reflect=function(){return this._then(f,f,void 0,this,void 0)};a.prototype.then=function(a,d,c){if(r()&&
0<arguments.length&&"function"!==typeof a&&"function"!==typeof d){var b=".then() only accepts functions but was passed: "+j.classString(a);1<arguments.length&&(b+=", "+j.classString(d));this._warn(b)}return this._then(a,d,c,void 0,void 0)};a.prototype.done=function(a,d,c){this._then(a,d,c,void 0,void 0)._setIsFinal()};a.prototype.spread=function(a,d){var c=this._target();return(c._isSpreadable()?c===this?this:this.then():this.all())._then(a,d,void 0,o,void 0)};a.prototype.isCancellable=function(){return!this.isResolved()&&
this._cancellable()};a.prototype.toJSON=function(){var a={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};this.isFulfilled()?(a.fulfillmentValue=this.value(),a.isFulfilled=!0):this.isRejected()&&(a.rejectionReason=this.reason(),a.isRejected=!0);return a};a.prototype.all=function(){var a=(new p(this)).promise();a._setIsSpreadable();return a};a.prototype.error=function(a){return this.caught(j.originatesFromRejection,a)};a.is=function(d){return d instanceof a};a.fromNode=
function(d){var b=new a(c),d=w(d)(y(b));d===h&&b._rejectCallback(d.e,!0,!0);return b};a.all=function(a){a=(new p(a)).promise();a._setIsSpreadable();return a};a.defer=a.pending=function(){var b=new a(c);return new d(b)};a.cast=function(d){d=t(d);if(!(d instanceof a)){var b=d,d=new a(c);d._fulfillUnchecked(b)}return d};a.resolve=a.fulfilled=a.cast;a.reject=a.rejected=function(d){var b=new a(c);b._captureStackTrace();b._rejectCallback(d,!0);return b};a.setScheduler=function(a){if("function"!==typeof a)throw new l("fn must be a function\n\n    See http://goo.gl/916lJJ\n");
var d=b._schedule;b._schedule=a;return d};a.prototype._then=function(d,f,g,h,e){var m=void 0!==e,e=m?e:new a(c);m||(e._propagateFrom(this,5),e._captureStackTrace());var o=this._target();o!==this&&!m&&(e._setIsMigrated(),void 0===h&&(e._setIsMigratingBinding(),h=this));d=o._addCallbacks(d,f,g,e,h);o._isResolved()&&!o._isSettlePromisesQueued()&&b.invoke(o._settlePromiseAtPostResolution,o,d);return e};a.prototype._settlePromiseAtPostResolution=function(a){this._isRejectionUnhandled()&&this._unsetRejectionIsUnhandled();
this._settlePromiseAt(a)};a.prototype._length=function(){return this._bitField&131071};a.prototype._isFollowingOrFulfilledOrRejected=function(){return 0<(this._bitField&939524096)};a.prototype._isFollowing=function(){return 536870912===(this._bitField&536870912)};a.prototype._setLength=function(a){this._bitField=this._bitField&-131072|a&131071};a.prototype._setFulfilled=function(){this._bitField|=268435456};a.prototype._setRejected=function(){this._bitField|=134217728};a.prototype._setFollowing=function(){this._bitField|=
536870912};a.prototype._setIsFinal=function(){this._bitField|=33554432};a.prototype._isFinal=function(){return 0<(this._bitField&33554432)};a.prototype._cancellable=function(){return 0<(this._bitField&67108864)};a.prototype._setCancellable=function(){this._bitField|=67108864};a.prototype._unsetCancellable=function(){this._bitField&=-67108865};a.prototype._isSpreadable=function(){return 0<(this._bitField&131072)};a.prototype._setIsSpreadable=function(){this._bitField|=131072};a.prototype._setIsMigrated=
function(){this._bitField|=4194304};a.prototype._unsetIsMigrated=function(){this._bitField&=-4194305};a.prototype._isMigrated=function(){return 0<(this._bitField&4194304)};a.prototype._receiverAt=function(a){a=0===a?this._receiver0:this[5*a-5+4];return this._isBound()&&void 0===a?this._boundTo:a};a.prototype._promiseAt=function(a){return 0===a?this._promise0:this[5*a-5+3]};a.prototype._fulfillmentHandlerAt=function(a){return 0===a?this._fulfillmentHandler0:this[5*a-5+0]};a.prototype._rejectionHandlerAt=
function(a){return 0===a?this._rejectionHandler0:this[5*a-5+1]};a.prototype._migrateCallbacks=function(d,c){var b=d._fulfillmentHandlerAt(c),f=d._rejectionHandlerAt(c),g=d._progressHandlerAt(c),h=d._promiseAt(c),e=d._receiverAt(c);h instanceof a&&(h._setIsMigrated(),void 0===e&&(e=d,h._setIsMigratingBinding()));this._addCallbacks(b,f,g,h,e)};a.prototype._addCallbacks=function(a,d,c,b,f){var g=this._length();131066<=g&&(g=0,this._setLength(0));if(0===g){if(this._promise0=b,void 0!==f&&(this._receiver0=
f),"function"===typeof a&&!this._isCarryingStackTrace()&&(this._fulfillmentHandler0=a),"function"===typeof d&&(this._rejectionHandler0=d),"function"===typeof c)this._progressHandler0=c}else{var h=5*g-5;this[h+3]=b;this[h+4]=f;"function"===typeof a&&(this[h+0]=a);"function"===typeof d&&(this[h+1]=d);"function"===typeof c&&(this[h+2]=c)}this._setLength(g+1);return g};a.prototype._setProxyHandlers=function(a,d){var c=this._length();131066<=c&&(c=0,this._setLength(0));if(0===c)this._promise0=d,this._receiver0=
a;else{var b=5*c-5;this[b+3]=d;this[b+4]=a}this._setLength(c+1)};a.prototype._proxyPromiseArray=function(a,d){this._setProxyHandlers(a,d)};a.prototype._resolveCallback=function(d,c){if(!this._isFollowingOrFulfilledOrRejected()){if(d===this)return this._rejectCallback(g(),!1,!0);var b=t(d,this);if(!(b instanceof a))return this._fulfill(d);this._propagateFrom(b,1|(c?4:0));b=b._target();if(b._isPending()){for(var f=this._length(),h=0;h<f;++h)b._migrateCallbacks(this,h);this._setFollowing();this._setLength(0);
this._setFollowee(b)}else b._isFulfilled()?this._fulfillUnchecked(b._value()):this._rejectUnchecked(b._reason(),b._getCarriedStackTrace())}};a.prototype._rejectCallback=function(a,d,c){c||j.markAsOriginatingFromRejection(a);var c=j.ensureErrorObject(a),b=j.canAttachTrace(a)&&"string"===typeof c.stack&&0<c.stack.length;this._attachExtraTrace(c,d?b:!1);this._reject(a,c===a?void 0:c)};a.prototype._resolveFromResolver=function(a){var d=this;this._captureStackTrace();this._pushContext();var c=!0,a=w(a)(function(a){null!==
d&&(d._resolveCallback(a),d=null)},function(a){null!==d&&(d._rejectCallback(a,c),d=null)}),c=!1;this._popContext();void 0!==a&&(a===h&&null!==d)&&(d._rejectCallback(a.e,!0,!0),d=null)};a.prototype._settlePromiseFromHandler=function(a,d,c,b){b._isRejected()||(b._pushContext(),a=d===o&&!this._isRejected()?w(a).apply(this._boundTo,c):w(a).call(d,c),b._popContext(),a===h||a===b||a===m?(a=a===b?g():a.e,b._rejectCallback(a,!1,!0)):b._resolveCallback(a))};a.prototype._target=function(){for(var a=this;a._isFollowing();)a=
a._followee();return a};a.prototype._followee=function(){return this._rejectionHandler0};a.prototype._setFollowee=function(a){this._rejectionHandler0=a};a.prototype._cleanValues=function(){this._cancellable()&&(this._cancellationParent=void 0)};a.prototype._propagateFrom=function(a,d){0<(d&1)&&a._cancellable()&&(this._setCancellable(),this._cancellationParent=a);0<(d&4)&&this._setBoundTo(a._boundTo)};a.prototype._fulfill=function(a){this._isFollowingOrFulfilledOrRejected()||this._fulfillUnchecked(a)};
a.prototype._reject=function(a,d){this._isFollowingOrFulfilledOrRejected()||this._rejectUnchecked(a,d)};a.prototype._settlePromiseAt=function(d){var c=this._promiseAt(d),f=c instanceof a;if(f&&c._isMigrated())return c._unsetIsMigrated(),b.invoke(this._settlePromiseAt,this,d);var g=this._isFulfilled()?this._fulfillmentHandlerAt(d):this._rejectionHandlerAt(d),h=this._isCarryingStackTrace()?this._getCarriedStackTrace():void 0,e=this._settledValue,m=this._receiverAt(d);f&&c._isMigratingBinding()&&(c._unsetIsMigratingBinding(),
m=m._boundTo);this._clearCallbackDataAtIndex(d);"function"===typeof g?f?this._settlePromiseFromHandler(g,m,e,c):g.call(m,e,c):m instanceof p?m._isResolved()||(this._isFulfilled()?m._promiseFulfilled(e,c):m._promiseRejected(e,c)):f&&(this._isFulfilled()?c._fulfill(e):c._reject(e,h));4<=d&&4===(d&31)&&b.invokeLater(this._setLength,this,0)};a.prototype._clearCallbackDataAtIndex=function(a){0===a?(this._isCarryingStackTrace()||(this._fulfillmentHandler0=void 0),this._rejectionHandler0=this._progressHandler0=
this._receiver0=this._promise0=void 0):(a=5*a-5,this[a+3]=this[a+4]=this[a+0]=this[a+1]=this[a+2]=void 0)};a.prototype._isSettlePromisesQueued=function(){return-1073741824===(this._bitField&-1073741824)};a.prototype._setSettlePromisesQueued=function(){this._bitField|=-1073741824};a.prototype._unsetSettlePromisesQueued=function(){this._bitField&=1073741823};a.prototype._queueSettlePromises=function(){b.settlePromises(this);this._setSettlePromisesQueued()};a.prototype._fulfillUnchecked=function(a){if(a===
this)return a=g(),this._attachExtraTrace(a),this._rejectUnchecked(a,void 0);this._setFulfilled();this._settledValue=a;this._cleanValues();0<this._length()&&this._queueSettlePromises()};a.prototype._rejectUncheckedCheckError=function(a){var d=j.ensureErrorObject(a);this._rejectUnchecked(a,d===a?void 0:d)};a.prototype._rejectUnchecked=function(a,d){if(a===this){var c=g();this._attachExtraTrace(c);return this._rejectUnchecked(c)}this._setRejected();this._settledValue=a;this._cleanValues();this._isFinal()?
b.throwLater(function(a){"stack"in a&&b.invokeFirst(k.unhandledRejection,void 0,a);throw a;},void 0===d?a:d):(void 0!==d&&d!==a&&this._setCarriedStackTrace(d),0<this._length()?this._queueSettlePromises():this._ensurePossibleRejectionHandled())};a.prototype._settlePromises=function(){this._unsetSettlePromisesQueued();for(var a=this._length(),d=0;d<a;d++)this._settlePromiseAt(d)};a._makeSelfResolutionError=g;e("./method.js")(a,c,t,i);e("./bind.js")(a,c,t);e("./finally.js")(a,m,t);e("./direct_resolve.js")(a);
e("./synchronous_inspection.js")(a);e("./join.js")(a,p,t,c);j.toFastProperties(a);j.toFastProperties(a.prototype);a.Promise=a;k.setBounds(b.firstLineError,j.lastLineError);e("./cancel.js")(a);e("./map.js")(a,p,i,t,c);e("./nodeify.js")(a);e("./progress.js")(a,p);e("./promisify.js")(a,c);e("./reduce.js")(a,p,i,t,c);e("./timers.js")(a,c);e("./each.js")(a,c);e("./filter.js")(a,c);a.prototype=a.prototype;return a}},{"./async.js":1,"./bind.js":2,"./cancel.js":4,"./captured_trace.js":5,"./catch_filter.js":6,
"./context.js":7,"./debuggability.js":8,"./direct_resolve.js":9,"./each.js":10,"./errors.js":11,"./filter.js":13,"./finally.js":14,"./join.js":15,"./map.js":16,"./method.js":17,"./nodeify.js":18,"./progress.js":19,"./promise_array.js":21,"./promise_resolver.js":22,"./promisify.js":23,"./reduce.js":25,"./synchronous_inspection.js":27,"./thenables.js":28,"./timers.js":29,"./util.js":30}],21:[function(e,k){k.exports=function(a,g,f,i){function j(a){switch(a){case -2:return[];case -3:return{}}}function b(b){var c=
this._promise=new a(g);b instanceof a&&c._propagateFrom(b,5);this._values=b;this._totalResolved=this._length=0;this._init(void 0,-2)}var n=e("./util.js").isArray;b.prototype.length=function(){return this._length};b.prototype.promise=function(){return this._promise};b.prototype._init=function c(b,g){var e=f(this._values,this._promise);if(e instanceof a)if(e._setBoundTo(this._promise._boundTo),this._values=e=e._target(),e._isFulfilled()){if(e=e._value(),!n(e)){this.__hardReject__(new a.TypeError("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n"));
return}}else{e._isPending()?e._then(c,this._reject,void 0,this,g):this._reject(e._reason());return}else if(!n(e)){this._promise._reject(i("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n")._reason());return}if(0===e.length)-5===g?this._resolveEmptyArray():this._resolve(j(g));else{var p=this.getActualLength(e.length);this._length=p;this._values=this.shouldCopyValues()?Array(p):this._values;for(var k=this._promise,r=0;r<p;++r){var v=this._isResolved(),d=f(e[r],k);d instanceof
a?(d=d._target(),v?d._unsetRejectionIsUnhandled():d._isPending()?d._proxyPromiseArray(this,r):d._isFulfilled()?this._promiseFulfilled(d._value(),r):this._promiseRejected(d._reason(),r)):v||this._promiseFulfilled(d,r)}}};b.prototype._isResolved=function(){return null===this._values};b.prototype._resolve=function(a){this._values=null;this._promise._fulfill(a)};b.prototype.__hardReject__=b.prototype._reject=function(a){this._values=null;this._promise._rejectCallback(a,!1,!0)};b.prototype._promiseProgressed=
function(a,b){this._promise._progress({index:b,value:a})};b.prototype._promiseFulfilled=function(a,b){this._values[b]=a;++this._totalResolved>=this._length&&this._resolve(this._values)};b.prototype._promiseRejected=function(a){this._totalResolved++;this._reject(a)};b.prototype.shouldCopyValues=function(){return!0};b.prototype.getActualLength=function(a){return a};return b}},{"./util.js":30}],22:[function(e,k){function a(a){return function(c,e){if(null!==a){if(c){var i;i=f(c);var j;if(i instanceof
Error&&n.getPrototypeOf(i)===Error.prototype){j=new b(i);j.name=i.name;j.message=i.message;j.stack=i.stack;for(var k=n.keys(i),v=0;v<k.length;++v){var d=k[v];l.test(d)||(j[d]=i[d])}i=j}else g.markAsOriginatingFromRejection(i);a._attachExtraTrace(i);a._reject(i)}else if(2<arguments.length){i=arguments.length;j=Array(i-1);for(k=1;k<i;++k)j[k-1]=arguments[k];a._fulfill(j)}else a._fulfill(e);a=null}}}var g=e("./util.js"),f=g.maybeWrapAsError,i=e("./errors.js"),j=i.TimeoutError,b=i.OperationalError,i=
g.haveGetters,n=e("./es5.js"),l=/^(?:name|message|stack|cause)$/,c;c=i?function(a){this.promise=a}:function(c){this.promise=c;this.callback=this.asCallback=a(c)};i&&(i={get:function(){return a(this.promise)}},n.defineProperty(c.prototype,"asCallback",i),n.defineProperty(c.prototype,"callback",i));c._nodebackForPromise=a;c.prototype.toString=function(){return"[object PromiseResolver]"};c.prototype.resolve=c.prototype.fulfill=function(a){if(!(this instanceof c))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");
this.promise._resolveCallback(a)};c.prototype.reject=function(a){if(!(this instanceof c))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._rejectCallback(a)};c.prototype.progress=function(a){if(!(this instanceof c))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");
this.promise._progress(a)};c.prototype.cancel=function(a){this.promise.cancel(a)};c.prototype.timeout=function(){this.reject(new j("timeout"))};c.prototype.isResolved=function(){return this.promise.isResolved()};c.prototype.toJSON=function(){return this.promise.toJSON()};k.exports=c},{"./errors.js":11,"./es5.js":12,"./util.js":30}],23:[function(e,k){k.exports=function(a,g){function f(a){try{return!0===a.__isPromisified__}catch(c){return!1}}function i(a,c,b,g){for(var e=l.inheritedDataKeys(a),m=[],
i=0;i<e.length;++i){var j=e[i],o=a[j],n=g===u?!0:u(j,o,a),k;if(k="function"===typeof o)if(k=!f(o))k=l.getDataPropertyOrDefault(a,j+c,r),k=!(k&&f(k))&&g(j,o,a,n);k&&m.push(j,o)}for(a=0;a<m.length;a+=2)if(g=m[a],b.test(g)){g=g.replace(b,"");for(e=0;e<m.length;e+=2)if(m[e]===g)throw new p("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/iWrZbw\n".replace("%s",c));}return m}function j(d,b){function f(){var e=b;b===n&&(e=this);"string"===typeof d&&(d=e[d]);var h=
new a(g);h._captureStackTrace();h._setIsSpreadable();var i=c(h);try{d.apply(e,o(arguments,i))}catch(j){e=m(j),h._attachExtraTrace(e),h._reject(e)}return h}f.__isPromisified__=!0;return f}function b(a,c,b,f){for(var g=RegExp(c.replace(/([$])/,"\\$")+"$"),b=i(a,c,g,b),g=0,e=b.length;g<e;g+=2){var m=b[g],j=b[g+1];a[m+c]=f===v?v(m,n,m,j,c):f(j,function(){return v(m,n,m,j,c)})}l.toFastProperties(a);return a}var n={},l=e("./util.js"),c=e("./promise_resolver.js")._nodebackForPromise,o=l.withAppended,m=l.maybeWrapAsError,
k=l.canEvaluate,p=e("./errors").TypeError,u=function(a,c){return l.isIdentifier(a)&&"_"!==a.charAt(0)&&!l.isClass(c)},r={__isPromisified__:!0},v=k?void 0:j;a.promisify=function(a,c){if("function"!==typeof a)throw new p("fn must be a function\n\n    See http://goo.gl/916lJJ\n");return f(a)?a:v(a,2>arguments.length?n:c,void 0,a)};a.promisifyAll=function(a,c){if("function"!==typeof a&&"object"!==typeof a)throw new p("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/9ITlV0\n");
var c=Object(c),g=c.suffix;"string"!==typeof g&&(g="Async");var f=c.filter;"function"!==typeof f&&(f=u);var e=c.promisifier;"function"!==typeof e&&(e=v);if(!l.isIdentifier(g))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/8FZo5V\n");for(var m=l.inheritedDataKeys(a,{includeHidden:!0}),i=0;i<m.length;++i){var j=a[m[i]];"constructor"!==m[i]&&l.isClass(j)&&(b(j.prototype,g,f,e),b(j,g,f,e))}return b(a,g,f,e)}}},{"./errors":11,"./promise_resolver.js":22,"./util.js":30}],
24:[function(e,k){function a(a){this._capacity=a;this._front=this._length=0}a.prototype._willBeOverCapacity=function(a){return this._capacity<a};a.prototype._pushOne=function(a){var f=this.length();this._checkCapacity(f+1);this[this._front+f&this._capacity-1]=a;this._length=f+1};a.prototype._unshiftOne=function(a){var f=this._capacity;this._checkCapacity(this.length()+1);f=(this._front-1&f-1^f)-f;this[f]=a;this._front=f;this._length=this.length()+1};a.prototype.unshift=function(a,f,e){this._unshiftOne(e);
this._unshiftOne(f);this._unshiftOne(a)};a.prototype.push=function(a,f,e){var j=this.length()+3;if(this._willBeOverCapacity(j))this._pushOne(a),this._pushOne(f),this._pushOne(e);else{var b=this._front+j-3;this._checkCapacity(j);var k=this._capacity-1;this[b+0&k]=a;this[b+1&k]=f;this[b+2&k]=e;this._length=j}};a.prototype.shift=function(){var a=this._front,f=this[a];this[a]=void 0;this._front=a+1&this._capacity-1;this._length--;return f};a.prototype.length=function(){return this._length};a.prototype._checkCapacity=
function(a){this._capacity<a&&this._resizeTo(this._capacity<<1)};a.prototype._resizeTo=function(a){var f=this._capacity;this._capacity=a;for(var a=this._front+this._length&f-1,e=0;e<a;++e)this[e+f]=this[e+0],this[e+0]=void 0};k.exports=a},{}],25:[function(e,k){k.exports=function(a,g,f,i,j){function b(c,b,f,e){this.constructor$(c);this._promise._captureStackTrace();this._preservedValues=e===j?[]:null;this._zerothIsAccum=void 0===f;this._gotAccum=!1;this._reducingIndex=this._zerothIsAccum?1:0;this._valuesPhase=
void 0;var c=i(f,this._promise),e=!1,g=c instanceof a;g&&(c=c._target(),c._isPending()?c._proxyPromiseArray(this,-1):c._isFulfilled()?(f=c._value(),this._gotAccum=!0):(this._reject(c._reason()),e=!0));!g&&!this._zerothIsAccum&&(this._gotAccum=!0);this._callback=b;this._accum=f;e||this._init$(void 0,-5)}function k(a,c,e,g){return"function"!==typeof c?f("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):(new b(a,c,e,g)).promise()}var l=e("./util.js"),c=l.tryCatch,o=l.errorObj;l.inherits(b,g);
b.prototype._init=function(){};b.prototype._resolveEmptyArray=function(){if(this._gotAccum||this._zerothIsAccum)this._resolve(null!==this._preservedValues?[]:this._accum)};b.prototype._promiseFulfilled=function(b,f){var e=this._values;e[f]=b;var g=this.length(),j=this._preservedValues,k=null!==j,d=this._gotAccum,l=this._valuesPhase,h;if(!l){l=this._valuesPhase=Array(g);for(h=0;h<g;++h)l[h]=0}h=l[f];0===f&&this._zerothIsAccum?(this._accum=b,this._gotAccum=d=!0,l[f]=0===h?1:2):-1===f?(this._accum=b,
this._gotAccum=d=!0):0===h?l[f]=1:(l[f]=2,this._accum=b);if(d){for(var d=this._callback,n=this._promise._boundTo,q=this._reducingIndex;q<g;++q)if(h=l[q],2===h)this._reducingIndex=q+1;else{if(1!==h)return;b=e[q];this._promise._pushContext();k?(j.push(b),h=c(d).call(n,b,q,g)):h=c(d).call(n,this._accum,b,q,g);this._promise._popContext();if(h===o)return this._reject(h.e);var s=i(h,this._promise);if(s instanceof a){s=s._target();if(s._isPending())return l[q]=4,s._proxyPromiseArray(this,q);if(s._isFulfilled())h=
s._value();else return this._reject(s._reason())}this._reducingIndex=q+1;this._accum=h}this._resolve(k?j:this._accum)}};a.prototype.reduce=function(a,c){return k(this,a,c,null)};a.reduce=function(a,c,b,f){return k(a,c,b,f)}}},{"./util.js":30}],26:[function(e,k){var a;e("./util.js").isNode?(a=process.version.split(".").map(Number),a=0===a[0]&&10<a[1]||0<a[0]?global.setImmediate:process.nextTick):"undefined"!==typeof MutationObserver?(a=function(a){var f=document.createElement("div");(new MutationObserver(a)).observe(f,
{attributes:!0});return function(){f.classList.toggle("foo")}},a.isStatic=!0):a="undefined"!==typeof setTimeout?function(a){setTimeout(a,0)}:function(){throw Error("No async scheduler available\n\n    See http://goo.gl/m3OTXk\n");};k.exports=a},{"./util.js":30}],27:[function(e,k){k.exports=function(a){function e(a){void 0!==a?(a=a._target(),this._bitField=a._bitField,this._settledValue=a._settledValue):(this._bitField=0,this._settledValue=void 0)}e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n");
return this._settledValue};e.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n");return this._settledValue};e.prototype.isFulfilled=a.prototype._isFulfilled=function(){return 0<(this._bitField&268435456)};e.prototype.isRejected=a.prototype._isRejected=function(){return 0<(this._bitField&134217728)};e.prototype.isPending=a.prototype._isPending=function(){return 0===(this._bitField&
402653184)};e.prototype.isResolved=a.prototype._isResolved=function(){return 0<(this._bitField&402653184)};a.prototype.isPending=function(){return this._target()._isPending()};a.prototype.isRejected=function(){return this._target()._isRejected()};a.prototype.isFulfilled=function(){return this._target()._isFulfilled()};a.prototype.isResolved=function(){return this._target()._isResolved()};a.prototype._value=function(){return this._settledValue};a.prototype._reason=function(){this._unsetRejectionIsUnhandled();
return this._settledValue};a.prototype.value=function(){var a=this._target();if(!a.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n");return a._settledValue};a.prototype.reason=function(){var a=this._target();if(!a.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n");a._unsetRejectionIsUnhandled();return a._settledValue};a.PromiseInspection=e}},{}],28:[function(e,
k){k.exports=function(a,g){function f(a){return a.then}function i(c,e,f){var i=new a(g),k=i;f&&f._pushContext();i._captureStackTrace();f&&f._popContext();var l=!0,e=j.tryCatch(e).call(c,function(b){i&&(c===b?i._rejectCallback(a._makeSelfResolutionError(),!1,!0):i._resolveCallback(b),i=null)},function(a){i&&(i._rejectCallback(a,l,!0),i=null)},function(a){i&&"function"===typeof i._progress&&i._progress(a)}),l=!1;i&&e===b&&(i._rejectCallback(e.e,!0,!0),i=null);return k}var j=e("./util.js"),b=j.errorObj,
k=j.isObject,l={}.hasOwnProperty;return function(c,e){if(k(c)){if(c instanceof a)return c;if(l.call(c,"_promise0")){var m=new a(g);c._then(m._fulfillUnchecked,m._rejectUncheckedCheckError,m._progressUnchecked,m,null);return m}m=j.tryCatch(f)(c);if(m===b)return e&&e._pushContext(),m=a.reject(m.e),e&&e._popContext(),m;if("function"===typeof m)return i(c,m,e)}return c}}},{"./util.js":30}],29:[function(e,k){k.exports=function(a,g){function f(a){var b=this;b instanceof Number&&(b=+b);clearTimeout(b);return a}
function i(a){var b=this;b instanceof Number&&(b=+b);clearTimeout(b);throw a;}var j=e("./util.js"),b=a.TimeoutError,k=function(a){return l(+this).thenReturn(a)},l=a.delay=function(b,e){if(void 0===e){var e=b,b=void 0,f=new a(g);setTimeout(function(){f._fulfill()},e);return f}return a.resolve(b)._then(k,null,null,+e,void 0)};a.prototype.delay=function(a){return l(this,a)};a.prototype.timeout=function(a,e){var a=+a,g=this.then().cancellable();g._cancellationParent=this;var k=setTimeout(function(){var a=
e;g.isPending()&&("string"!==typeof a&&(a="operation timed out"),a=new b(a),j.markAsOriginatingFromRejection(a),g._attachExtraTrace(a),g._cancel(a))},a);return g._then(f,i,void 0,k,void 0)}}},{"./util.js":30}],30:[function(e,k){function a(){try{return m.apply(this,arguments)}catch(a){return o.e=a,o}}function g(a){return"string"===typeof a?a:""+a}function f(a){return null==a||!0===a||!1===a||"string"===typeof a||"number"===typeof a}function i(a,b,c){if(f(a))return a;n.defineProperty(a,b,{value:c,configurable:!0,
enumerable:!1,writable:!0});return a}function j(a){return a instanceof Error&&n.propertyIsWritable(a,"stack")}function b(a){return{}.toString.call(a)}var n=e("./es5.js"),l="undefined"==typeof navigator,c=function(){try{var a={};n.defineProperty(a,"f",{get:function(){return 3}});return 3===a.f}catch(b){return!1}}(),o={e:{}},m,t=function(){return"string"!==this}.call("string"),p=function(){return n.isES5?function(a,b){for(var c=[],e=Object.create(null),f=Object(b).includeHidden?Object.getOwnPropertyNames:
Object.keys;null!=a;){var g;try{g=f(a)}catch(i){break}for(var j=0;j<g.length;++j){var k=g[j];if(!e[k]){e[k]=!0;var l=Object.getOwnPropertyDescriptor(a,k);null!=l&&(null==l.get&&null==l.set)&&c.push(k)}}a=n.getPrototypeOf(a)}return c}:function(a){var b=[],c;for(c in a)b.push(c);return b}}(),u=/^[a-z$_][a-z$_0-9]*$/i,r=function(){return"stack"in Error()?function(a){return j(a)?a:Error(a+"")}:function(a){if(j(a))return a;try{throw Error(a+"");}catch(b){return b}}}(),l={isClass:function(a){try{if("function"===
typeof a){var b=n.keys(a.prototype);return 0<b.length&&!(1===b.length&&"constructor"===b[0])}return!1}catch(c){return!1}},isIdentifier:function(a){return u.test(a)},inheritedDataKeys:p,getDataPropertyOrDefault:function(a,b,c){if(n.isES5){if(a=Object.getOwnPropertyDescriptor(a,b),null!=a)return null==a.get&&null==a.set?a.value:c}else return{}.hasOwnProperty.call(a,b)?a[b]:void 0},thrower:function(a){throw a;},isArray:n.isArray,haveGetters:c,notEnumerableProp:i,isPrimitive:f,isObject:function(a){return!f(a)},
canEvaluate:l,errorObj:o,tryCatch:function(b){m=b;return a},inherits:function(a,b){function c(){this.constructor=a;this.constructor$=b;for(var f in b.prototype)e.call(b.prototype,f)&&"$"!==f.charAt(f.length-1)&&(this[f+"$"]=b.prototype[f])}var e={}.hasOwnProperty;c.prototype=b.prototype;a.prototype=new c;return a.prototype},withAppended:function(a,b){var c=a.length,e=Array(c+1),f;for(f=0;f<c;++f)e[f]=a[f];e[f]=b;return e},asString:g,maybeWrapAsError:function(a){return!f(a)?a:Error(g(a))},wrapsPrimitiveReceiver:t,
toFastProperties:function(a){function b(){}b.prototype=a;return b},filledRange:function(a,b,c){for(var e=Array(a),f=0;f<a;++f)e[f]=b+f+c;return e},toString:function(a){return a+""},canAttachTrace:j,ensureErrorObject:r,originatesFromRejection:function(a){return null==a?!1:a instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===a.isOperational},markAsOriginatingFromRejection:function(a){try{i(a,"isOperational",!0)}catch(b){}},classString:b,isNode:"undefined"!==typeof process&&"[object process]"===
b(process).toLowerCase()};try{throw Error();}catch(v){l.lastLineError=v}k.exports=l},{"./es5.js":12}]},{},[3])(3)});"undefined"!==typeof window&&null!==window?window.P=window.Promise:"undefined"!==typeof self&&null!==self&&(self.P=self.Promise);
