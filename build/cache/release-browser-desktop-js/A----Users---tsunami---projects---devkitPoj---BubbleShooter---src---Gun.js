4e4fc55ca4104ca584f1679c6c94d352
jsio("import ui.ImageView");jsio("import math.geom.Point as Point");jsio("import animate");jsio("import src.Bullet as Bullet");jsio("import src.Config as config");var Users_tsunami_projects_devkitPoj_BubbleShooter_src_Gun=__class__;
exports=Users_tsunami_projects_devkitPoj_BubbleShooter_src_Gun(function(){return this.init&&this.init.apply(this,arguments)},ui.ImageView,function(d){this.init=function(c){c=merge(c,{x:GLOBAL.SCREEN_SIZE.width/2-53,y:420,autoSize:!0,image:"resources/images/gun_base.png"});d(this,"init",[c]);this._color=Math.floor(5*Math.random());this.build()};this.build=function(){var c=new ui.ImageView({superview:this,x:-3,y:-70,autoSize:!0,image:"resources/images/gun.png",anchorX:53,anchorY:96}),d=new ui.ImageView({superview:this,
x:-100,y:-70,scale:0.6,autoSize:!0,image:"resources/images/girl.png"}),e=new ui.ImageView({superview:d,x:80,y:100,width:50,height:50,image:types[this._color]}),b=this;this.on("gun:setTarget",function(a){a=-1.57079-a.subtract(new Point(145,510)).getAngle();c.style.r=-a});this.on("gun:loaded",function(){animate(e).now({x:230,y:140},200,animate.linear).then(function(){var a=new Bullet({type:b._color,image:types[b._color]});b.getSuperview().addSubview(a);b._bullet=a;a._isLoaded=!0;b._color=Math.floor(5*
Math.random());e.updateOpts({x:80,y:100,image:types[b._color]})})});this.on("gun:fire",function(a){b._bullet._isLoaded&&a.y<b._bullet.style.y&&b._bullet.emit("bullet:launch",a)})}});var types=GLOBAL.TYPES;
