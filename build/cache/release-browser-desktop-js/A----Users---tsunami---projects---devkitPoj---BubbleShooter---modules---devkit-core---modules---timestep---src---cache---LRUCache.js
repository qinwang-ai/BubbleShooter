af86ba051fda5470325cc59323a5a146
var LRUCache=function(a){this.size=0;this.limit=a;this._keymap={}};LRUCache.prototype.put=function(a,c){var b={key:a,value:c};this._keymap[a]=b;this.tail?(this.tail.newer=b,b.older=this.tail):this.head=b;this.tail=b;if(this.size===this.limit)return this.shift();this.size++};LRUCache.prototype.shift=function(){var a=this.head;a&&(this.head.newer?(this.head=this.head.newer,this.head.older=void 0):this.head=void 0,a.newer=a.older=void 0,delete this._keymap[a.key]);return a};
LRUCache.prototype.get=function(a,c){var b=this._keymap[a];if(void 0!==b){if(b===this.tail)return c?b:b.value;b.newer&&(b===this.head&&(this.head=b.newer),b.newer.older=b.older);b.older&&(b.older.newer=b.newer);b.newer=void 0;if(b.older=this.tail)this.tail.newer=b;this.tail=b;return c?b:b.value}};LRUCache.prototype.find=function(a){return this._keymap[a]};LRUCache.prototype.set=function(a,c){var b,d=this.get(a,!0);if(d)b=d.value,d.value=c;else if(b=this.put(a,c))b=b.value;return b};
LRUCache.prototype.remove=function(a){if(a=this._keymap[a])return delete this._keymap[a.key],a.newer&&a.older?(a.older.newer=a.newer,a.newer.older=a.older):a.newer?(a.newer.older=void 0,this.head=a.newer):a.older?(a.older.newer=void 0,this.tail=a.older):this.head=this.tail=void 0,this.size--,a.value};LRUCache.prototype.removeAll=function(){this.head=this.tail=void 0;this.size=0;this._keymap={}};
LRUCache.prototype.keys="function"===typeof Object.keys?function(){return Object.keys(this._keymap)}:function(){var a=[],c;for(c in this._keymap)a.push(c);return a};LRUCache.prototype.forEach=function(a,c,b){!0===c?(b=!0,c=void 0):"object"!==typeof c&&(c=this);if(b)for(b=this.tail;b;)a.call(c,b.key,b.value,this),b=b.older;else for(b=this.head;b;)a.call(c,b.key,b.value,this),b=b.newer};
LRUCache.prototype.toJSON=function(){for(var a=[],c=this.head;c;)a.push({key:c.key.toJSON(),value:c.value.toJSON()}),c=c.newer;return a};LRUCache.prototype.toString=function(){for(var a="",c=this.head;c;)a+=""+c.key+":"+c.value,(c=c.newer)&&(a+=" < ");return a};exports=LRUCache;
