a1d2dbc12a4d1bd9f532de9df4647b9b
jsio("from util.browser import $");jsio("import .Widget");jsio("import squill.models.bindings as bindings");
var Users_tsunami_projects_devkitPoj_BubbleShooter_modules_devkit_core_modules_squill_TextInput=__class__,TextInput=exports=Users_tsunami_projects_devkitPoj_BubbleShooter_modules_devkit_core_modules_squill_TextInput(function(){return this.init&&this.init.apply(this,arguments)},Widget,function(b){this._type="text";this._css="textInput";this.init=function(a){a=merge(a,{name:"",value:"",multiline:!1});this._def={children:[{tag:a.multiline?"textarea":"input",id:"_input",attrs:{type:"text",value:a.value,
name:a.name},style:merge(a.textStyle,{MozBoxSizing:"border-box",WebkitBoxSizing:"border-box",MsBoxSizing:"border-box",boxSizing:"border-box"})}],style:{position:"relative"}};a.prefixLabel&&this._def.children.unshift({id:"_label",text:a.label});b(this,"init",[a])};this.buildWidget=function(){var a=this._el;"ontouchstart"in this._el&&(this._overlay=$({parent:this._el,attrs:{noCapture:!0},style:{position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%",zIndex:1}}),this._overlay.addEventListener("click",
bind(this,function(){$.hide(this._overlay);this._input.focus()}),!0));var c=this._opts;if(!c.prefixLabel||c.placeholder){var b=this.getI18n("label");null===this._input.getAttribute("placeholder")?this._input.setAttribute("placeholder",c.placeholder||b):this._placeholder=$.create({tag:"button",text:b,style:{position:"absolute"},parent:a})}this.initMouseEvents(a);this.initFocusEvents(this._input);this.initKeyEvents(this._input)};this.focus=function(){this._input.focus()};this.blur=function(){this._input.blur()};
this.getInputElement=function(){return this._input};this.setName=function(a){b(this,"setName",arguments);this._input&&(this._input.name=a)};this.setData=this.setValue=function(a){void 0===a&&(a="");this.saveSelection();this._value=this._input.value=a;this.restoreSelection()};this.getValue=function(){return this._input.value};this.onKeyDown=function(){b(this,"onKeyDown",arguments);this._placeholder&&$.hide(this._placeholder)};this.onKeyUp=function(){b(this,"onKeyUp",arguments);this.checkLabel();this.checkValue()};
this.onMouseDown=function(a){b(this,"onMouseDown",arguments);a.stopPropagation()};this.onKeyPress=function(a){b(this,"onKeyPress",arguments);13==a.keyCode&&this.publish("EnterPressed");this.checkValue()};this.onBlur=function(){b(this,"onBlur");this.checkLabel();this._overlay&&$.show(this._overlay)};this.isValid=function(){return this._isValid};this.checkValue=function(){var a=this._input.value,b=this._opts.formatter;b&&(a=b(a));a==INVALID_VALUE?(this._isValid=!1,$.addClass(this._el,"invalid")):(this._isValid=
!0,$.removeClass(this._el,"invalid"),this._value!=a&&(this._value=a,b=this._input,a!=b.value&&(this.saveSelection(),b.value=a,this.restoreSelection()),this.publish("change",this._value),this.publish("ValueChange",this._value)))};this.saveSelection=function(){this._selection={start:this._input.selectionStart,end:this._input.selectionEnd}};this.restoreSelection=function(){var a=this._input;this._isFocused&&(a.selectionStart=this._selection.start,a.selectionEnd=this._selection.end)};this.checkLabel=
function(){this._placeholder&&/^\s*$/.test(this._input.value)&&$.show(this._placeholder)};this.onClick=function(){b(this,"onClick")};this.setEnabled=function(a){(this._isEnabled=a)?(delete this._input.disabled,this.removeClass("disabled")):(this._input.disabled=!0,this.addClass("disabled"))};this.isFocused=function(){return this._isFocused};this.isEnabled=function(){return this._isEnabled};this.disable=function(){this.setEnabled(!1)};this.enable=function(){this.setEnabled(!0)}}),INVALID_VALUE=exports.INVALID_VALUE=
{};Widget.register(TextInput,"TextInput");
