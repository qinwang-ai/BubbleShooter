b0acdc453f257e678a925992fb41298e
jsio("import .Drag");jsio("import .Widget");jsio("import .transforms");jsio("from util.browser import $");var Users_tsunami_projects_devkitPoj_BubbleShooter_modules_devkit_core_modules_squill_Scroller=__class__;
exports=Users_tsunami_projects_devkitPoj_BubbleShooter_modules_devkit_core_modules_squill_Scroller(function(){return this.init&&this.init.apply(this,arguments)},Widget,function(d){this._css="scroller";this.init=function(a){a=merge(a,{momentum:!0});this._scrollTop=0;this._lastDelta={diff:0,when:0,duration:0};this._hasMomentum=a.momentum;d(this,"init",[a])};this.buildContent=function(){var a=this._el;$.style(a,{height:"100%"});this._scrollPane=$({parent:a,className:"squill-scrollPane",minHeight:"100%"});
"ontouchstart"in a?(a.addEventListener("touchstart",bind(this,"onTouchStart"),!0),a.addEventListener("mousedown",this,"start"),this.initDragEvents(),this._el.style.overflow="hidden",transforms.setTop(this._scrollPane,0)):this._el.style.overflow="auto";this._def&&(a=this._def,this._def=null,this.buildChildren(merge({el:this._scrollPane},a)));return d(this,"buildContent",arguments)};this.getScrollTop=function(){return this._scrollTop};this.getContainer=this.getScrollPane=function(){return this._scrollPane};
this.onTouchStart=function(){this._momentum&&clearInterval(this._momentum)};this.onDragStart=function(){this._height=this._scrollPane.offsetHeight-this._el.offsetHeight;this._lastDelta.when=+new Date;this._momentum&&clearInterval(this._momentum)};this.onDrag=function(a,b,c){a=+new Date;b=this._lastDelta;b.diff=c.y;b.duration=b.when&&a-b.when||0;b.when=a;this.scrollTo(this._scrollTop+c.y)};this.scrollTo=function(a,b){this._scrollTop=a;this._scrollTop<-this._height&&(this._scrollTop=-this._height);
0<this._scrollTop&&(this._scrollTop=0);this._el.setAttribute("squill-scroller-top",-this._scrollTop);var c=bind(this,function(){if(document.createEvent){var a=document.createEvent("HTMLEvents");a.initEvent("scroll",true,false);this._el.dispatchEvent(a)}});b?transforms.move(this._scrollPane,0,this._scrollTop,"0.5s ease-in-out",c):(transforms.move(this._scrollPane,0,this._scrollTop),c())};this.onDragStop=function(a,b){$.stopEvent(b);if(this._hasMomentum&&0!=this._lastDelta.duration){var c=this._lastDelta,
e=c.diff/c.duration,d=c.when;this._momentum=setInterval(bind(this,function(){var a=+new Date;this.scrollTo(this._scrollTop+e*(a-d));e*=0.95;0.01>Math.abs(e)&&(clearTimeout(this._momentum),this._momentum=null);d=a}),10)}}});
