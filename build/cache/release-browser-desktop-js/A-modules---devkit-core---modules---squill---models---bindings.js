50223adead6984b399053bb62390fcfc
var RE_BINDING=/(^|[^%])%\((.*?)\)([ +0-]?)(\d*)(\.?\d*)([dfcs])/g;exports.parseFormat=function(a,b){var c=[];b.replace(RE_BINDING,function(a,b,g,h,i,j,k,f){c.push({index:f+b.length,endIndex:f+a.length,key:g,pad:h||" ",minLength:parseInt(i),decimal:parseInt(j.substring(1)),type:k,value:""})});c.reverse();new Binding(a,null,b,c)};exports.parseData=function(a,b){new Binding(a,b)};
var Binding=__class__,Binding=Binding(function(){return this.init&&this.init.apply(this,arguments)},function(){this.init=function(a,b,c,d){var e=a.getOpts().__result,e=e&&e.getTarget()||a;this._widget=a;this._key=b;this._src=c;this._subs=d;this._connect(e.getModel());a.on("change",bind(this,"_updateModel"));e.on("model",bind(this,"_connect"))};this._connect=function(a){this._model&&this._disconnect();this._model=a;this._subs?(this._subs.forEach(function(b){b.value=a.get(b.key);a.subscribe(b.key,this,
"_update",b.key)},this),this._update()):this._key&&(a.subscribe(this._key,this,"_updateKey"),this._updateKey(a.get(this._key)))};this._disconnect=function(){var a=this._model;this._subs&&this._subs.forEach(function(b){a.unsubscribe(b.key,this)},this);this._key&&a.unsubscribe(this._key,this)};this._update=function(a,b){var c=this._src;this._subs.forEach(function(d){a&&d.key==a&&(d.value=b);c=c.substring(0,d.index)+d.value+c.substring(d.endIndex)},this);this._widget.setData(c)};this._updateKey=function(a){this._widget.setData(a)};
this._updateModel=function(a){this._model&&this._key&&this._model.set(this._key,a)}});
